<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Nodes · Macro</title><meta name="title" content="Nodes · Macro"/><meta property="og:title" content="Nodes · Macro"/><meta property="twitter:title" content="Nodes · Macro"/><meta name="description" content="Documentation for Macro."/><meta property="og:description" content="Documentation for Macro."/><meta property="twitter:description" content="Documentation for Macro."/><meta property="og:url" content="https://macroenergy.github.io/Macro/stable/Manual/Nodes/"/><meta property="twitter:url" content="https://macroenergy.github.io/Macro/stable/Manual/Nodes/"/><link rel="canonical" href="https://macroenergy.github.io/Macro/stable/Manual/Nodes/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Macro</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><input class="collapse-toggle" id="menuitem-1" type="checkbox"/><label class="tocitem" for="menuitem-1"><span class="docs-label">Welcome to Macro</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../../table_of_contents/">Table of contents</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Getting Started</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Getting Started/1_overview/">Overview</a></li><li><a class="tocitem" href="../../Getting Started/2_installation/">Installation</a></li><li><a class="tocitem" href="../../Getting Started/4_macro_repo_contents/">What&#39;s Included With Macro</a></li><li><a class="tocitem" href="../../Getting Started/3_first_run/">First Run</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Tutorials/tutorials_introduction/">Introduction</a></li><li><a class="tocitem" href="../../Tutorials/0_getting_started/">Getting Started</a></li><li><a class="tocitem" href="../../Tutorials/1_running_macro/">Running Macro</a></li><li><a class="tocitem" href="../../Tutorials/2_multisector_modelling/">Multisector Modelling</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Guides</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Guides/guides_introduction/">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">User Guide</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Guides/User Guide/user_build_system/">Create a System</a></li><li><a class="tocitem" href="../../Guides/User Guide/user_add_commodity/">Adding Commodities</a></li><li><a class="tocitem" href="../../Guides/User Guide/user_add_node/">Adding Nodes</a></li><li><a class="tocitem" href="../../Guides/User Guide/user_add_location/">Adding Locations</a></li><li><a class="tocitem" href="../../Guides/User Guide/user_add_asset/">Adding Assets</a></li><li><a class="tocitem" href="../../Guides/User Guide/user_policy_constraints/">Adding Policy constraints</a></li><li><a class="tocitem" href="../../Guides/User Guide/user_asset_constraints/">Adding Assets constraints</a></li><li><a class="tocitem" href="../../Guides/User Guide/user_settings/">Configuring Settings</a></li><li><a class="tocitem" href="../../Guides/User Guide/user_run_model/">Running Models</a></li><li><a class="tocitem" href="../../Guides/User Guide/user_write_results/">Writing Results</a></li><li><a class="tocitem" href="../../Guides/User Guide/user_multiperiod/">Using Multi-Period Models</a></li><li><a class="tocitem" href="../../Guides/User Guide/user_using_asset_libary/">Exploring the Asset library</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Modeler Guide</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Guides/Modeler Guide/modeler_introduction/">Introduction</a></li><li><a class="tocitem" href="../../Guides/Modeler Guide/modeler_es_graph/">Energy System Graph-Based Representation</a></li><li><a class="tocitem" href="../../Guides/Modeler Guide/modeler_build_sectors/">Creating a New Sector</a></li><li><a class="tocitem" href="../../Guides/Modeler Guide/modeler_build_asset/">Creating a New Asset</a></li><li><a class="tocitem" href="../../Guides/Modeler Guide/modeler_add_docs_to_asset/">Documenting an Asset</a></li><li><a class="tocitem" href="../../Guides/Modeler Guide/modeler_create_example_case/">Creating a New Example Case</a></li><li><a class="tocitem" href="../../Guides/Modeler Guide/modeler_workflow/">Suggested Development Workflow</a></li><li><a class="tocitem" href="../../Guides/Modeler Guide/modeler_debugging_testing/">Debugging and Testing Tips</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-4" type="checkbox"/><label class="tocitem" for="menuitem-4-4"><span class="docs-label">Developer Guide</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Guides/Developer Guide/dev_create_constraint/">Creating a Constraint</a></li><li><a class="tocitem" href="../../Guides/Developer Guide/2_type_hierarchy/">Type Hierarchy</a></li></ul></li></ul></li><li><a class="tocitem" href="../../Assets/assets_guide/">Assets</a></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox" checked/><label class="tocitem" for="menuitem-6"><span class="docs-label">Manual</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../manual_introduction/">Introduction</a></li><li><a class="tocitem" href="../Inputs/">Inputs</a></li><li><a class="tocitem" href="../Outputs/">Outputs</a></li><li><a class="tocitem" href="../System/">System</a></li><li><a class="tocitem" href="../Model/">Model</a></li><li><a class="tocitem" href="../Sectors/">Sectors</a></li><li><a class="tocitem" href="../Edges/">Edges</a></li><li class="is-active"><a class="tocitem" href>Nodes</a><ul class="internal"><li><a class="tocitem" href="#Contents"><span>Contents</span></a></li><li><a class="tocitem" href="#manual-nodes-overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Node-Fields"><span>Node Fields</span></a></li><li><a class="tocitem" href="#manual-nodes-types"><span>Types</span></a></li><li><a class="tocitem" href="#manual-nodes-constructors"><span>Constructors</span></a></li><li><a class="tocitem" href="#manual-nodes-methods"><span>Methods</span></a></li><li><a class="tocitem" href="#manual-nodes-examples"><span>Examples</span></a></li><li><a class="tocitem" href="#See-Also"><span>See Also</span></a></li></ul></li><li><a class="tocitem" href="../Storage/">Storage</a></li><li><a class="tocitem" href="../Transformations/">Transformations</a></li><li><a class="tocitem" href="../Locations/">Locations</a></li><li><a class="tocitem" href="../Constraints/">Constraints</a></li><li><a class="tocitem" href="../Commodities/">Commodities</a></li><li><a class="tocitem" href="../Assets/">Assets</a></li><li><input class="collapse-toggle" id="menuitem-6-15" type="checkbox"/><label class="tocitem" for="menuitem-6-15"><span class="docs-label">Asset Library</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../assets/battery/">Battery</a></li><li><a class="tocitem" href="../assets/beccselectricity/">BECCS Electricity</a></li><li><a class="tocitem" href="../assets/beccshydrogen/">BECCS Hydrogen</a></li><li><a class="tocitem" href="../assets/electricdac/">Electric DAC</a></li><li><a class="tocitem" href="../assets/electrolyzer/">Electrolyzer</a></li><li><a class="tocitem" href="../assets/fuelcell/">Fuel Cell</a></li><li><a class="tocitem" href="../assets/gasstorage/">Gas Storage</a></li><li><a class="tocitem" href="../assets/hydropower/">Hydro Reservoir</a></li><li><a class="tocitem" href="../assets/mustrun/">Must Run</a></li><li><a class="tocitem" href="../assets/natgasdaq/">Natural Gas DAC</a></li><li><a class="tocitem" href="../assets/thermalhydrogen/">Thermal Hydrogen Plant (with and without CCS)</a></li><li><a class="tocitem" href="../assets/thermalpower/">Thermal Power Plant (with and without CCS)</a></li><li><a class="tocitem" href="../assets/transmissionlink/">Transmission Link</a></li><li><a class="tocitem" href="../assets/vre/">Variable Renewable Energy Resources (VRE)</a></li></ul></li><li><a class="tocitem" href="../Financial_assumptions/">Financial Assumptions</a></li><li><a class="tocitem" href="../Multi_period_accounting/">Multi-Period Accounting</a></li></ul></li><li><a class="tocitem" href="../../how_to_contribute/">How to contribute</a></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox"/><label class="tocitem" for="menuitem-8"><span class="docs-label">References</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../References/1_introduction/">Introduction</a></li><li><a class="tocitem" href="../../References/2_reading_input/">Reading input data</a></li><li><a class="tocitem" href="../../References/3_macro_objects/">Macro Objects</a></li><li><a class="tocitem" href="../../References/4_writing_output/">Writing output data</a></li><li><a class="tocitem" href="../../References/5_utilities/">Utilities</a></li><li><a class="tocitem" href="../../References/ref_download_examples/">Downloading examples</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-9" type="checkbox"/><label class="tocitem" for="menuitem-9"><span class="docs-label">Appendix</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Appendix/TEA/">TEA</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Nodes</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Nodes</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/macroenergy/MacroEnergy.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/macroenergy/MacroEnergy.jl/blob/main/docs/src/Manual/Nodes.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Nodes"><a class="docs-heading-anchor" href="#Nodes">Nodes</a><a id="Nodes-1"></a><a class="docs-heading-anchor-permalink" href="#Nodes" title="Permalink"></a></h1><h2 id="Contents"><a class="docs-heading-anchor" href="#Contents">Contents</a><a id="Contents-1"></a><a class="docs-heading-anchor-permalink" href="#Contents" title="Permalink"></a></h2><p><a href="#manual-nodes-overview">Overview</a> | <a href="#Node-Fields">Fields</a> | <a href="#manual-nodes-types">Types</a> | <a href="#manual-nodes-constructors">Constructors</a> | <a href="#manual-nodes-methods">Methods</a> | <a href="#manual-nodes-examples">Examples</a></p><h2 id="manual-nodes-overview"><a class="docs-heading-anchor" href="#manual-nodes-overview">Overview</a><a id="manual-nodes-overview-1"></a><a class="docs-heading-anchor-permalink" href="#manual-nodes-overview" title="Permalink"></a></h2><p><code>Nodes</code> are balance points for flows of a single Commodity. They are one of the four primary components in Macro, alongside <code>Edges</code>, <code>Storage</code>, and <code>Transformations</code>. They are sub-types of the <code>Vertex</code> type.</p><p>Each <code>Node</code> can only balance flows of one Commodity so they are usually described with reference to that Commodity, e.g. as <code>Node{Electricity}</code>, <code>Node{Hydrogen}</code>, or <code>Node{CO2}</code>. The general description is a <code>Node{T}</code>, where <code>T</code> can be any Commodity or sub-Commodity.</p><p>Balances are an important and complicated topic in Macro. They are described in more detail in the <a href="../Balances/#Balances">Balances</a> section and specific balance constraints can be found in the <a href="../constraints/constraints_introduction/#Constraints-Library">Constraints Library</a>.</p><h3 id="Nodes-for-System-Boundaries"><a class="docs-heading-anchor" href="#Nodes-for-System-Boundaries">Nodes for System Boundaries</a><a id="Nodes-for-System-Boundaries-1"></a><a class="docs-heading-anchor-permalink" href="#Nodes-for-System-Boundaries" title="Permalink"></a></h3><p><code>Nodes</code> allow for the import and export of Commodities outside a model, making them essential for modeling system boundaries. This capability can be used to represent:</p><ul><li><strong>Fuel Supplies</strong>: Import of natural gas, coal, or other fuels from external sources</li><li><strong>Electricity Export</strong>: Export of electricity to neighboring grids or markets</li><li><strong>Emissions</strong>: Upstream emissions or downstream carbon capture and storage</li></ul><h4 id="Electricity-Node-in-a-regional-grid-model"><a class="docs-heading-anchor" href="#Electricity-Node-in-a-regional-grid-model">Electricity Node in a regional grid model</a><a id="Electricity-Node-in-a-regional-grid-model-1"></a><a class="docs-heading-anchor-permalink" href="#Electricity-Node-in-a-regional-grid-model" title="Permalink"></a></h4><p>An <code>Node{Electricity}</code> in a regional electricity model can represent the connection to neighboring grids. The <code>Node</code> can have both demand (representing local electricity consumption) and supply capabilities (representing imports from external grids), with associated costs and limits for each.</p><h4 id="Natural-Gas-Node-in-an-integrated-energy-system"><a class="docs-heading-anchor" href="#Natural-Gas-Node-in-an-integrated-energy-system">Natural Gas Node in an integrated energy system</a><a id="Natural-Gas-Node-in-an-integrated-energy-system-1"></a><a class="docs-heading-anchor-permalink" href="#Natural-Gas-Node-in-an-integrated-energy-system" title="Permalink"></a></h4><p>A <code>Node{NaturalGas}</code> can represent a natural gas supply point where the system can purchase fuel from external suppliers. The supply can have different cost segments, availability constraints, and time-varying prices to represent realistic fuel market conditions.</p><h3 id="Nodes-in-Locations"><a class="docs-heading-anchor" href="#Nodes-in-Locations">Nodes in Locations</a><a id="Nodes-in-Locations-1"></a><a class="docs-heading-anchor-permalink" href="#Nodes-in-Locations" title="Permalink"></a></h3><p>Several <code>Nodes</code> of different Commodities can be gathered into a <code>Location</code>, allowing other components to be connected to them as a group rather than individually. This organizational structure:</p><ul><li><strong>Simplifies Inputs</strong>: Reduces the complexity of input files by allowing Assets to connect to a Location rather than specifying individual Nodes</li><li><strong>Intuitive Modelling of Regions</strong>: Represents geographic regions with multiple commodity flows</li><li><strong>Automative Creation of Nodes</strong>: Macro can automatically create Nodes for each Commodity in a Location when a corresponding <code>Edge</code> is connected, simplifying the model setup</li></ul><p>For example, a city Location might contain <code>Node{Electricity}</code>, <code>Node{NaturalGas}</code>, and <code>Node{Hydrogen}</code> representing the local infrastructure for each commodity. A power plant Asset can then be connected to this Location, automatically gaining access to all relevant commodity flows.</p><h3 id="Nodes-within-Assets"><a class="docs-heading-anchor" href="#Nodes-within-Assets">Nodes within Assets</a><a id="Nodes-within-Assets-1"></a><a class="docs-heading-anchor-permalink" href="#Nodes-within-Assets" title="Permalink"></a></h3><p><code>Nodes</code> can also be used within Assets to merge or split flows of a Commodity or several sub-Commodities. This allows for:</p><ul><li><strong>Flow Aggregation</strong>: Combining multiple sub-commodity flows into a single commodity flow. For example, a System may track <code>CleanElectricity</code> and <code>FossilElectricity</code> as sub-commodities of a broader <code>Electricity</code> commodity. If part of the System is not concerned with the distinction, a <code>Node{Electricity}</code> can aggregate these flows into a single <code>Electricity</code> commodity</li><li><strong>Flow Distribution</strong>: Splitting a single commodity flow into multiple streams which can be used by different Components or other Assets. For example, a <code>Node{Electricity}</code> in a power plant Asset might be used to split the generated electricity flow for grid export and station power.</li></ul><h3 id="Key-Concepts"><a class="docs-heading-anchor" href="#Key-Concepts">Key Concepts</a><a id="Key-Concepts-1"></a><a class="docs-heading-anchor-permalink" href="#Key-Concepts" title="Permalink"></a></h3><ul><li><strong>Single Commodity Balance</strong>: Each Node balances flows of exactly one Commodity type.</li><li><strong>System Boundaries</strong>: Nodes enable import/export of commodities to/from external systems</li><li><strong>Demand and Supply</strong>: Nodes can have both demand requirements and supply capabilities</li><li><strong>Location Grouping</strong>: Multiple Nodes can be organized into Locations for simplified connectivity</li><li><strong>Flexible Segmentation</strong>: Demand and supply can be segmented with different costs and limits</li><li><strong>Time Dependence</strong>: Support time-varying demand, supply, and pricing parameters</li></ul><h2 id="Node-Fields"><a class="docs-heading-anchor" href="#Node-Fields">Node Fields</a><a id="Node-Fields-1"></a><a class="docs-heading-anchor-permalink" href="#Node-Fields" title="Permalink"></a></h2><p><code>Nodes</code> have the following fields. When running a model, the fields are set by the input files. When creating an Asset, the defaults below can be altered using the <code>@node_data</code> macro. The internal fields are used by Macro and are not intended to be set by users in most circumstances.</p><div class="admonition is-info" id="Units-in-Macro-fa43ee5504ac88cc"><header class="admonition-header">Units in Macro<a class="admonition-anchor" href="#Units-in-Macro-fa43ee5504ac88cc" title="Permalink"></a></header><div class="admonition-body"><p>We have assumed that your System is using units of MWh for energy, tonnes for mass, and hour-long time steps. You can use any set of units as long as they are consistent across your operations and investment inputs.</p></div></div><h3 id="Network-Structure"><a class="docs-heading-anchor" href="#Network-Structure">Network Structure</a><a id="Network-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#Network-Structure" title="Permalink"></a></h3><table><tr><th style="text-align: right">Field</th><th style="text-align: right">Type</th><th style="text-align: right">Description</th><th style="text-align: right">Default</th></tr><tr><td style="text-align: right"><code>id</code></td><td style="text-align: right">Symbol</td><td style="text-align: right">Unique identifier</td><td style="text-align: right">-</td></tr><tr><td style="text-align: right"><code>location</code></td><td style="text-align: right">Union{Missing,Symbol}</td><td style="text-align: right">Location where node is placed</td><td style="text-align: right">missing</td></tr></table><h3 id="Demand-Parameters"><a class="docs-heading-anchor" href="#Demand-Parameters">Demand Parameters</a><a id="Demand-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Demand-Parameters" title="Permalink"></a></h3><table><tr><th style="text-align: right">Field</th><th style="text-align: right">Type</th><th style="text-align: right">Description</th><th style="text-align: right">Units</th><th style="text-align: right">Default</th></tr><tr><td style="text-align: right"><code>demand</code></td><td style="text-align: right">Vector{Float64}</td><td style="text-align: right">Time-varying demand requirements</td><td style="text-align: right">MWh/hr</td><td style="text-align: right">Float64[]</td></tr><tr><td style="text-align: right"><code>max_nsd</code></td><td style="text-align: right">Vector{Float64}</td><td style="text-align: right">Maximum non-served demand by segment</td><td style="text-align: right">MWh/hr</td><td style="text-align: right">[0.0]</td></tr><tr><td style="text-align: right"><code>min_nsd</code></td><td style="text-align: right">Vector{Float64}</td><td style="text-align: right">Minimum non-served demand by segment</td><td style="text-align: right">MWh/hr</td><td style="text-align: right">[0.0]</td></tr><tr><td style="text-align: right"><code>price_nsd</code></td><td style="text-align: right">Vector{Float64}</td><td style="text-align: right">Penalty cost for non-served demand</td><td style="text-align: right"><span>$</span>/MWh</td><td style="text-align: right">[0.0]</td></tr></table><h3 id="Supply-Parameters"><a class="docs-heading-anchor" href="#Supply-Parameters">Supply Parameters</a><a id="Supply-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Supply-Parameters" title="Permalink"></a></h3><table><tr><th style="text-align: right">Field</th><th style="text-align: right">Type</th><th style="text-align: right">Description</th><th style="text-align: right">Units</th><th style="text-align: right">Default</th></tr><tr><td style="text-align: right"><code>max_supply</code></td><td style="text-align: right">Vector{Float64}</td><td style="text-align: right">Maximum supply by segment</td><td style="text-align: right">MWh/hr</td><td style="text-align: right">[0.0]</td></tr><tr><td style="text-align: right"><code>price_supply</code></td><td style="text-align: right">Vector{Float64}</td><td style="text-align: right">Cost of supply by segment</td><td style="text-align: right"><span>$</span>/MWh</td><td style="text-align: right">[0.0]</td></tr><tr><td style="text-align: right"><code>price</code></td><td style="text-align: right">Vector{Float64}</td><td style="text-align: right">Time-varying commodity prices</td><td style="text-align: right"><span>$</span>/MWh</td><td style="text-align: right">Float64[]</td></tr></table><h3 id="Policy-Parameters"><a class="docs-heading-anchor" href="#Policy-Parameters">Policy Parameters</a><a id="Policy-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Policy-Parameters" title="Permalink"></a></h3><table><tr><th style="text-align: right">Field</th><th style="text-align: right">Type</th><th style="text-align: right">Description</th><th style="text-align: right">Units</th><th style="text-align: right">Default</th></tr><tr><td style="text-align: right"><code>price_unmet_policy</code></td><td style="text-align: right">Dict{Symbol,Any}</td><td style="text-align: right">Penalty costs for unmet policy constraints</td><td style="text-align: right">varies</td><td style="text-align: right">Dict{Symbol,Any}()</td></tr><tr><td style="text-align: right"><code>rhs_policy</code></td><td style="text-align: right">Dict{Symbol,Any}</td><td style="text-align: right">Right-hand side values for policy constraints</td><td style="text-align: right">varies</td><td style="text-align: right">Dict{Symbol,Any}()</td></tr></table><h3 id="Balance-and-Constraint-Tracking-(Internal)"><a class="docs-heading-anchor" href="#Balance-and-Constraint-Tracking-(Internal)">Balance and Constraint Tracking (Internal)</a><a id="Balance-and-Constraint-Tracking-(Internal)-1"></a><a class="docs-heading-anchor-permalink" href="#Balance-and-Constraint-Tracking-(Internal)" title="Permalink"></a></h3><table><tr><th style="text-align: right">Field</th><th style="text-align: right">Type</th><th style="text-align: right">Description</th><th style="text-align: right">Units</th><th style="text-align: right">Default</th></tr><tr><td style="text-align: right"><code>balance_data</code></td><td style="text-align: right">Dict{Symbol,Dict{Symbol,Float64}}</td><td style="text-align: right">Balance equation coefficients</td><td style="text-align: right">-</td><td style="text-align: right">Dict{Symbol,Dict{Symbol,Float64}}()</td></tr><tr><td style="text-align: right"><code>constraints</code></td><td style="text-align: right">Vector{AbstractTypeConstraint}</td><td style="text-align: right">Additional constraints</td><td style="text-align: right">-</td><td style="text-align: right">Vector{AbstractTypeConstraint}()</td></tr><tr><td style="text-align: right"><code>operation_expr</code></td><td style="text-align: right">Dict</td><td style="text-align: right">Operational JuMP expressions</td><td style="text-align: right">-</td><td style="text-align: right">Dict()</td></tr></table><h3 id="Operational-Variables-(Internal)"><a class="docs-heading-anchor" href="#Operational-Variables-(Internal)">Operational Variables (Internal)</a><a id="Operational-Variables-(Internal)-1"></a><a class="docs-heading-anchor-permalink" href="#Operational-Variables-(Internal)" title="Permalink"></a></h3><table><tr><th style="text-align: right">Field</th><th style="text-align: right">Type</th><th style="text-align: right">Description</th><th style="text-align: right">Units</th><th style="text-align: right">Default</th></tr><tr><td style="text-align: right"><code>non_served_demand</code></td><td style="text-align: right">JuMPVariable</td><td style="text-align: right">Non-served demand variables</td><td style="text-align: right">MWh/hr</td><td style="text-align: right">Matrix{VariableRef}(undef, 0, 0)</td></tr><tr><td style="text-align: right"><code>supply_flow</code></td><td style="text-align: right">JuMPVariable</td><td style="text-align: right">Supply flow variables</td><td style="text-align: right">MWh/hr</td><td style="text-align: right">Matrix{VariableRef}(undef, 0, 0)</td></tr><tr><td style="text-align: right"><code>policy_budgeting_vars</code></td><td style="text-align: right">Dict</td><td style="text-align: right">Policy constraint budgeting variables</td><td style="text-align: right">varies</td><td style="text-align: right">Dict()</td></tr><tr><td style="text-align: right"><code>policy_slack_vars</code></td><td style="text-align: right">Dict</td><td style="text-align: right">Policy constraint slack variables</td><td style="text-align: right">varies</td><td style="text-align: right">Dict()</td></tr></table><h2 id="manual-nodes-types"><a class="docs-heading-anchor" href="#manual-nodes-types">Types</a><a id="manual-nodes-types-1"></a><a class="docs-heading-anchor-permalink" href="#manual-nodes-types" title="Permalink"></a></h2><h3 id="Type-Hierarchy"><a class="docs-heading-anchor" href="#Type-Hierarchy">Type Hierarchy</a><a id="Type-Hierarchy-1"></a><a class="docs-heading-anchor-permalink" href="#Type-Hierarchy" title="Permalink"></a></h3><p><code>Node</code> types follow a hierarchical structure rooted in the abstract <code>AbstractVertex</code> type:</p><pre><code class="language-julia hljs">AbstractVertex
├── Node{T}
├── AbstractStorage{T}
│   ├── Storage{T}
│   └── LongDurationStorage{T}
└── Transformation{T}</code></pre><h3 id="Node{T}"><a class="docs-heading-anchor" href="#Node{T}">Node{T}</a><a id="Node{T}-1"></a><a class="docs-heading-anchor-permalink" href="#Node{T}" title="Permalink"></a></h3><p>Concrete implementation of a network node parameterized by commodity type <code>T</code>.</p><h2 id="manual-nodes-constructors"><a class="docs-heading-anchor" href="#manual-nodes-constructors">Constructors</a><a id="manual-nodes-constructors-1"></a><a class="docs-heading-anchor-permalink" href="#manual-nodes-constructors" title="Permalink"></a></h2><h3 id="Keyword-Constructors"><a class="docs-heading-anchor" href="#Keyword-Constructors">Keyword Constructors</a><a id="Keyword-Constructors-1"></a><a class="docs-heading-anchor-permalink" href="#Keyword-Constructors" title="Permalink"></a></h3><pre><code class="language-julia hljs">Node{T}(; id::Symbol, timedata::TimeData, [additional_fields...])</code></pre><p>Direct constructor using keyword arguments for all fields, where <code>T</code> is the type of commodity flowing through the Node, e.g. <code>Electricity</code>, <code>NaturalGas</code>, etc.</p><table><tr><th style="text-align: right">Parameter</th><th style="text-align: right">Type</th><th style="text-align: right">Description</th><th style="text-align: right">Required</th></tr><tr><td style="text-align: right"><code>id</code></td><td style="text-align: right">Symbol</td><td style="text-align: right">Unique identifier</td><td style="text-align: right">Yes</td></tr><tr><td style="text-align: right"><code>timedata</code></td><td style="text-align: right">TimeData</td><td style="text-align: right">Time-related data structure</td><td style="text-align: right">Yes</td></tr><tr><td style="text-align: right"><code>location</code></td><td style="text-align: right">Union{Missing, Symbol}</td><td style="text-align: right">Location identifier</td><td style="text-align: right">No</td></tr><tr><td style="text-align: right"><code>demand</code></td><td style="text-align: right">Vector{Float64}</td><td style="text-align: right">Time-varying demand</td><td style="text-align: right">No</td></tr><tr><td style="text-align: right"><code>max_supply</code></td><td style="text-align: right">Vector{Float64}</td><td style="text-align: right">Maximum supply by segment</td><td style="text-align: right">No</td></tr><tr><td style="text-align: right"><code>price</code></td><td style="text-align: right">Vector{Float64}</td><td style="text-align: right">Time-varying prices</td><td style="text-align: right">No</td></tr><tr><td style="text-align: right"><code>max_nsd</code></td><td style="text-align: right">Vector{Float64}</td><td style="text-align: right">Maximum non-served demand segments</td><td style="text-align: right">No</td></tr><tr><td style="text-align: right"><code>price_nsd</code></td><td style="text-align: right">Vector{Float64}</td><td style="text-align: right">Penalty prices for non-served demand</td><td style="text-align: right">No</td></tr><tr><td style="text-align: right"><code>...</code></td><td style="text-align: right">Various</td><td style="text-align: right">Additional node-specific fields</td><td style="text-align: right">No</td></tr></table><h3 id="Primary-Constructors"><a class="docs-heading-anchor" href="#Primary-Constructors">Primary Constructors</a><a id="Primary-Constructors-1"></a><a class="docs-heading-anchor-permalink" href="#Primary-Constructors" title="Permalink"></a></h3><pre><code class="language-julia hljs">Node(data::AbstractDict{Symbol,Any}, time_data::TimeData, commodity::DataType)</code></pre><p>Creates a Node from input data dictionary, time data, and commodity type.</p><table><tr><th style="text-align: right">Parameter</th><th style="text-align: right">Type</th><th style="text-align: right">Description</th></tr><tr><td style="text-align: right"><code>data</code></td><td style="text-align: right">AbstractDict{Symbol,Any}</td><td style="text-align: right">Dictionary of node configuration data</td></tr><tr><td style="text-align: right"><code>time_data</code></td><td style="text-align: right">TimeData</td><td style="text-align: right">Time-related data structure</td></tr><tr><td style="text-align: right"><code>commodity</code></td><td style="text-align: right">DataType</td><td style="text-align: right">Commodity type for the node</td></tr></table><h3 id="Factory-Constructors"><a class="docs-heading-anchor" href="#Factory-Constructors">Factory Constructors</a><a id="Factory-Constructors-1"></a><a class="docs-heading-anchor-permalink" href="#Factory-Constructors" title="Permalink"></a></h3><pre><code class="language-julia hljs">make_node(data::AbstractDict{Symbol,Any}, time_data::TimeData, commodity::DataType)

make(commodity::Type{&lt;:Commodity}, input_data::AbstractDict{Symbol,Any}, system)</code></pre><p>Factory methods for creating Nodes. The <code>make_node()</code> function is the internal constructor, while <code>make()</code> is the high-level factory method used when creating nodes from commodity types.</p><table><tr><th style="text-align: right">Parameter</th><th style="text-align: right">Type</th><th style="text-align: right">Description</th></tr><tr><td style="text-align: right"><code>data</code>/<code>input_data</code></td><td style="text-align: right">AbstractDict{Symbol,Any}</td><td style="text-align: right">Configuration data for the node</td></tr><tr><td style="text-align: right"><code>time_data</code></td><td style="text-align: right">TimeData</td><td style="text-align: right">Time-related data structure</td></tr><tr><td style="text-align: right"><code>commodity</code></td><td style="text-align: right">Type{&lt;:Commodity}</td><td style="text-align: right">Commodity type to create node for</td></tr><tr><td style="text-align: right"><code>system</code></td><td style="text-align: right">System</td><td style="text-align: right">Parent system object (for <code>make()</code>)</td></tr></table><h2 id="manual-nodes-methods"><a class="docs-heading-anchor" href="#manual-nodes-methods">Methods</a><a id="manual-nodes-methods-1"></a><a class="docs-heading-anchor-permalink" href="#manual-nodes-methods" title="Permalink"></a></h2><h3 id="Accessor-Methods"><a class="docs-heading-anchor" href="#Accessor-Methods">Accessor Methods</a><a id="Accessor-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Accessor-Methods" title="Permalink"></a></h3><p>Methods for accessing node data and properties.</p><table><tr><th style="text-align: right">Method</th><th style="text-align: right">Description</th><th style="text-align: right">Return Type</th></tr><tr><td style="text-align: right"><code>id(n::Node)</code></td><td style="text-align: right">Get node identifier</td><td style="text-align: right"><code>Symbol</code></td></tr><tr><td style="text-align: right"><code>commodity_type(n::Node{T})</code></td><td style="text-align: right">Get commodity type parameter</td><td style="text-align: right"><code>DataType</code></td></tr><tr><td style="text-align: right"><code>demand(n::Node)</code></td><td style="text-align: right">Get full demand vector</td><td style="text-align: right"><code>Vector{Float64}</code></td></tr><tr><td style="text-align: right"><code>demand(n::Node, t::Int64)</code></td><td style="text-align: right">Get demand at time period t</td><td style="text-align: right"><code>Float64</code></td></tr><tr><td style="text-align: right"><code>price(n::Node)</code></td><td style="text-align: right">Get full price vector</td><td style="text-align: right"><code>Vector{Float64}</code></td></tr><tr><td style="text-align: right"><code>price(n::Node, t::Int64)</code></td><td style="text-align: right">Get price at time period t</td><td style="text-align: right"><code>Float64</code></td></tr></table><h3 id="Demand-and-Non-Served-Demand-Methods"><a class="docs-heading-anchor" href="#Demand-and-Non-Served-Demand-Methods">Demand and Non-Served Demand Methods</a><a id="Demand-and-Non-Served-Demand-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Demand-and-Non-Served-Demand-Methods" title="Permalink"></a></h3><p>Methods for managing demand requirements and non-served demand.</p><table><tr><th style="text-align: right">Method</th><th style="text-align: right">Description</th><th style="text-align: right">Return Type</th></tr><tr><td style="text-align: right"><code>max_non_served_demand(n::Node)</code></td><td style="text-align: right">Get maximum non-served demand by segment</td><td style="text-align: right"><code>Vector{Float64}</code></td></tr><tr><td style="text-align: right"><code>max_non_served_demand(n::Node, s::Int64)</code></td><td style="text-align: right">Get maximum non-served demand for segment s</td><td style="text-align: right"><code>Float64</code></td></tr><tr><td style="text-align: right"><code>non_served_demand(n::Node)</code></td><td style="text-align: right">Get non-served demand variables</td><td style="text-align: right"><code>JuMPVariable</code></td></tr><tr><td style="text-align: right"><code>non_served_demand(n::Node, s::Int64, t::Int64)</code></td><td style="text-align: right">Get non-served demand for segment s at time t</td><td style="text-align: right"><code>VariableRef</code></td></tr><tr><td style="text-align: right"><code>price_non_served_demand(n::Node)</code></td><td style="text-align: right">Get penalty prices for non-served demand</td><td style="text-align: right"><code>Vector{Float64}</code></td></tr><tr><td style="text-align: right"><code>price_non_served_demand(n::Node, s::Int64)</code></td><td style="text-align: right">Get penalty price for non-served demand segment s</td><td style="text-align: right"><code>Float64</code></td></tr><tr><td style="text-align: right"><code>segments_non_served_demand(n::Node)</code></td><td style="text-align: right">Get range of non-served demand segments</td><td style="text-align: right"><code>UnitRange{Int64}</code></td></tr></table><h3 id="Supply-Methods"><a class="docs-heading-anchor" href="#Supply-Methods">Supply Methods</a><a id="Supply-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Supply-Methods" title="Permalink"></a></h3><p>Methods for managing supply capabilities and flows.</p><table><tr><th style="text-align: right">Method</th><th style="text-align: right">Description</th><th style="text-align: right">Return Type</th></tr><tr><td style="text-align: right"><code>max_supply(n::Node)</code></td><td style="text-align: right">Get maximum supply by segment</td><td style="text-align: right"><code>Vector{Float64}</code></td></tr><tr><td style="text-align: right"><code>max_supply(n::Node, s::Int64)</code></td><td style="text-align: right">Get maximum supply for segment s</td><td style="text-align: right"><code>Float64</code></td></tr><tr><td style="text-align: right"><code>supply_flow(n::Node)</code></td><td style="text-align: right">Get supply flow variables</td><td style="text-align: right"><code>JuMPVariable</code></td></tr><tr><td style="text-align: right"><code>supply_flow(n::Node, s::Int64, t::Int64)</code></td><td style="text-align: right">Get supply flow for segment s at time t</td><td style="text-align: right"><code>VariableRef</code></td></tr><tr><td style="text-align: right"><code>price_supply(n::Node, s::Int64)</code></td><td style="text-align: right">Get supply price for segment s</td><td style="text-align: right"><code>Float64</code></td></tr><tr><td style="text-align: right"><code>supply_segments(n::Node)</code></td><td style="text-align: right">Get range of supply segments</td><td style="text-align: right"><code>Base.OneTo{Int64}</code></td></tr></table><h3 id="Policy-Methods"><a class="docs-heading-anchor" href="#Policy-Methods">Policy Methods</a><a id="Policy-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Policy-Methods" title="Permalink"></a></h3><p>Methods for managing policy constraints and variables.</p><table><tr><th style="text-align: right">Method</th><th style="text-align: right">Description</th><th style="text-align: right">Return Type</th></tr><tr><td style="text-align: right"><code>policy_budgeting_vars(n::Node)</code></td><td style="text-align: right">Get policy budgeting variables</td><td style="text-align: right"><code>Dict</code></td></tr><tr><td style="text-align: right"><code>policy_slack_vars(n::Node)</code></td><td style="text-align: right">Get policy slack variables</td><td style="text-align: right"><code>Dict</code></td></tr><tr><td style="text-align: right"><code>price_unmet_policy(n::Node)</code></td><td style="text-align: right">Get penalty prices for unmet policy constraints</td><td style="text-align: right"><code>Dict{DataType,Float64}</code></td></tr><tr><td style="text-align: right"><code>price_unmet_policy(n::Node, c::DataType)</code></td><td style="text-align: right">Get penalty price for unmet policy constraint of type c</td><td style="text-align: right"><code>Float64</code></td></tr><tr><td style="text-align: right"><code>rhs_policy(n::Node)</code></td><td style="text-align: right">Get right-hand side values for policy constraints</td><td style="text-align: right"><code>Dict{DataType,Float64}</code></td></tr><tr><td style="text-align: right"><code>rhs_policy(n::Node, c::DataType)</code></td><td style="text-align: right">Get right-hand side value for policy constraint of type c</td><td style="text-align: right"><code>Float64</code></td></tr></table><h3 id="Balance-and-Constraint-Methods-(Inherited-from-AbstractVertex)"><a class="docs-heading-anchor" href="#Balance-and-Constraint-Methods-(Inherited-from-AbstractVertex)">Balance and Constraint Methods (Inherited from AbstractVertex)</a><a id="Balance-and-Constraint-Methods-(Inherited-from-AbstractVertex)-1"></a><a class="docs-heading-anchor-permalink" href="#Balance-and-Constraint-Methods-(Inherited-from-AbstractVertex)" title="Permalink"></a></h3><p>Methods for managing balance equations and constraints.</p><table><tr><th style="text-align: right">Method</th><th style="text-align: right">Description</th><th style="text-align: right">Return Type</th></tr><tr><td style="text-align: right"><code>balance_ids(n::Node)</code></td><td style="text-align: right">Get IDs of all balance equations</td><td style="text-align: right"><code>Vector{Symbol}</code></td></tr><tr><td style="text-align: right"><code>balance_data(n::Node, i::Symbol)</code></td><td style="text-align: right">Get input data for balance equation i</td><td style="text-align: right"><code>Dict{Symbol,Float64}</code></td></tr><tr><td style="text-align: right"><code>get_balance(n::Node, i::Symbol)</code></td><td style="text-align: right">Get balance equation expression for i</td><td style="text-align: right"><code>JuMP.Expression</code></td></tr><tr><td style="text-align: right"><code>get_balance(n::Node, i::Symbol, t::Int64)</code></td><td style="text-align: right">Get balance equation expression for i at time t</td><td style="text-align: right"><code>JuMP.Expression</code></td></tr><tr><td style="text-align: right"><code>all_constraints(n::Node)</code></td><td style="text-align: right">Get all constraints applied to the node</td><td style="text-align: right"><code>Vector{AbstractTypeConstraint}</code></td></tr><tr><td style="text-align: right"><code>all_constraints_types(n::Node)</code></td><td style="text-align: right">Get types of all constraints</td><td style="text-align: right"><code>Vector{DataType}</code></td></tr><tr><td style="text-align: right"><code>get_constraint_by_type(n::Node, constraint_type)</code></td><td style="text-align: right">Get constraint of specified type</td><td style="text-align: right"><code>AbstractTypeConstraint</code></td></tr></table><h3 id="Model-Building-Methods"><a class="docs-heading-anchor" href="#Model-Building-Methods">Model Building Methods</a><a id="Model-Building-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Model-Building-Methods" title="Permalink"></a></h3><p>Methods used internally during model construction.</p><table><tr><th style="text-align: right">Method</th><th style="text-align: right">Description</th><th style="text-align: right">Return Type</th></tr><tr><td style="text-align: right"><code>add_linking_variables!(n::Node, model::Model)</code></td><td style="text-align: right">Add linking variables to JuMP model</td><td style="text-align: right"><code>Nothing</code></td></tr><tr><td style="text-align: right"><code>define_available_capacity!(n::Node, model::Model)</code></td><td style="text-align: right">Define available capacity constraints</td><td style="text-align: right"><code>Nothing</code></td></tr><tr><td style="text-align: right"><code>planning_model!(n::Node, model::Model)</code></td><td style="text-align: right">Add planning model constraints</td><td style="text-align: right"><code>Nothing</code></td></tr><tr><td style="text-align: right"><code>operation_model!(n::Node, model::Model)</code></td><td style="text-align: right">Add operational model constraints</td><td style="text-align: right"><code>Nothing</code></td></tr></table><h3 id="Utility-Methods"><a class="docs-heading-anchor" href="#Utility-Methods">Utility Methods</a><a id="Utility-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Utility-Methods" title="Permalink"></a></h3><p>Additional utility methods for working with Nodes.</p><table><tr><th style="text-align: right">Method</th><th style="text-align: right">Description</th><th style="text-align: right">Return Type</th></tr><tr><td style="text-align: right"><code>get_nodes_sametype(nodes::Vector{Node}, commodity::DataType)</code></td><td style="text-align: right">Filter nodes by commodity type</td><td style="text-align: right"><code>Vector{Node}</code></td></tr><tr><td style="text-align: right"><code>make(commodity::Type{&lt;:Commodity}, input_data, system)</code></td><td style="text-align: right">Factory method for creating nodes</td><td style="text-align: right"><code>Node{T}</code></td></tr></table><h2 id="manual-nodes-examples"><a class="docs-heading-anchor" href="#manual-nodes-examples">Examples</a><a id="manual-nodes-examples-1"></a><a class="docs-heading-anchor-permalink" href="#manual-nodes-examples" title="Permalink"></a></h2><h3 id="Nodes-in-Node-list"><a class="docs-heading-anchor" href="#Nodes-in-Node-list">Nodes in Node list</a><a id="Nodes-in-Node-list-1"></a><a class="docs-heading-anchor-permalink" href="#Nodes-in-Node-list" title="Permalink"></a></h3><p>The most common way to use Nodes is to add them to the list of Nodes in your Macro System. The Node list is most commonly stored in the <code>system/nodes.json</code> file. The Commodity of each Node is defined by the <code>type</code> field, then further parameters can be given in the <code>instance_data</code> field or <code>global_data</code> field if defining several Nodes of the same type. Each Node must have a unique <code>id</code> which is used to identify the Node in the System and Model.</p><h4 id="Electricity-Nodes-with-non-served-demand"><a class="docs-heading-anchor" href="#Electricity-Nodes-with-non-served-demand">Electricity Nodes with non-served demand</a><a id="Electricity-Nodes-with-non-served-demand-1"></a><a class="docs-heading-anchor-permalink" href="#Electricity-Nodes-with-non-served-demand" title="Permalink"></a></h4><p>In this example, we&#39;ll define two Electricity Nodes with non-served demand (NSD) limits. NSD limits are defined by:</p><ol><li>Providing a vector of demand segments in the <code>max_nsd</code> field. Each segment is the fraction of this Nodes&#39;s demand that can be met by NSD each time step. A value of <code>[1.0]</code> indicated that the entire demand can be non-served.  </li><li>Providing a vector of prices in the <code>price_nsd</code> field, of the same length as the <code>max_nsd</code> field. Each segment is the price per MWh of non-served demand for the corresponding segment. Here, we have defined a NSD price of <span>$</span>5000/MWh.</li><li>We have to add a <code>MaxNonServedDemandConstraint</code> constraint to the <code>constraints</code> field to enfore the NSD limit. If we wish to use multiple segments, we also need to add a <code>MaxNonServedDemandPerSegmentConstraint</code> constraint.</li></ol><p>We want both Nodes to have the same NSD limits, so we can define these in the <code>global_data</code> field. To define different limits or prices, we could move the <code>max_nsd</code> and / or <code>price_nsd</code> fields to the <code>instance_data</code> field of each Node.</p><p>Both Nodes have exogenous Electricity demand, which is defined in the <code>demand</code> field. You could simply provide the data as an array of Float64 values but here we have used the <code>timeseries</code> feature to instead load the demand from a different file, in this case <code>system/demand.csv</code>. The <code>header</code> field specifies the column in the CSV file to use for each Node&#39;s demand.</p><p>Lastly, we have added <code>location</code> fields to both Nodes. This is not required but will allow other components to connect to these Nodes by Location rather than by Node ID. This can simplify model inputs and connectivity. Each Location can only have one Node of each Commodity or Sub-Commodity and Macro will throw an error if you try to add a second Node of the same Commodity to a Location.</p><pre><code class="language-json hljs">{
    &quot;nodes&quot;: [
        {
            &quot;type&quot;: &quot;Electricity&quot;,
            &quot;global_data&quot;: {
                &quot;global_data&quot;: {
                    &quot;time_interval&quot;: &quot;Electricity&quot;,
                    &quot;max_nsd&quot;: [1.0],
                    &quot;price_nsd&quot;: [5000.0],
                    &quot;constraints&quot;: {
                        &quot;BalanceConstraint&quot;: true,
                        &quot;MaxNonServedDemandConstraint&quot;: true,
                        &quot;MaxNonServedDemandPerSegmentConstraint&quot;: true
                    }
                }
            },
            &quot;instance_data&quot;: [
                {
                    &quot;id&quot;: &quot;boston_electricity&quot;,
                    &quot;location&quot;: &quot;boston&quot;,
                    &quot;demand&quot;: {
                        &quot;timeseries&quot;: {
                            &quot;path&quot;: &quot;system/demand.csv&quot;,
                            &quot;header&quot;: &quot;Demand_Boston&quot;
                        }
                    }
                },
                {
                    &quot;id&quot;: &quot;princeton_electricity&quot;,
                    &quot;location&quot;: &quot;princeton&quot;,
                    &quot;demand&quot;: {
                        &quot;timeseries&quot;: {
                            &quot;path&quot;: &quot;system/demand.csv&quot;,
                            &quot;header&quot;: &quot;Demand_Princeton&quot;
                        }
                    }
                }
            ]
        }
    ]
}</code></pre><h4 id="Biomass-Node-with-Supply-Segments"><a class="docs-heading-anchor" href="#Biomass-Node-with-Supply-Segments">Biomass Node with Supply Segments</a><a id="Biomass-Node-with-Supply-Segments-1"></a><a class="docs-heading-anchor-permalink" href="#Biomass-Node-with-Supply-Segments" title="Permalink"></a></h4><p>Nodes can also be used to supply Commodities from outside your System. Here, we define two Biomass Nodes which are used to supply biomass to the System for use as fuel. As in the previous example, we have used a mixture of <code>global_data</code> and <code>instance_data</code> to define the Nodes. We have also added both to Locations so that other components can connect to them by Location rather than by Node ID.</p><p>Adding external supply is similar to adding demand, but we use the <code>max_supply</code> and <code>price_supply</code> fields and there is no need to add constraints beyong the basic <code>BalanceConstraint</code>. The <code>max_supply</code> field is a vector of the maximum number of units which can be supplied each time step for each segment. These are individual segments of supply, not cumulative supply. The <code>price_supply</code> field is a vector of prices per unit for each segment. We recommend listing the segments in order of increasing price. This is not necessary for Macro to handle them correctly but will make the results easier to interpret.</p><pre><code class="language-json hljs">{
    &quot;type&quot;: &quot;Biomass&quot;,
    &quot;global_data&quot;: {
        &quot;time_interval&quot;: &quot;Biomass&quot;,
        &quot;constraints&quot;: {
            &quot;BalanceConstraint&quot;: true
        }
    },
    &quot;instance_data&quot;: [
        {
            &quot;id&quot;: &quot;boston_bioherb&quot;,
            &quot;location&quot;: &quot;boston&quot;,
            &quot;max_supply&quot;: [
                3000.0,
                1000.0,
                2000.0
            ],
            &quot;price_supply&quot;: [
                80.0,
                100.0,
                150.0
            ]
        },
        {
            &quot;id&quot;: &quot;princeton_bioherb&quot;,
            &quot;location&quot;: &quot;princeton&quot;,
            &quot;max_supply&quot;: [
                500.0,
                3000.0,
                1000.0
            ],
            &quot;price_supply&quot;: [
                80.0,
                100.0,
                150.0
            ]
        }
    ]
}           </code></pre><h4 id="Emissions-Nodes"><a class="docs-heading-anchor" href="#Emissions-Nodes">Emissions Nodes</a><a id="Emissions-Nodes-1"></a><a class="docs-heading-anchor-permalink" href="#Emissions-Nodes" title="Permalink"></a></h4><p>Tracking and constraining emissions is an important part of many energy system models. In Macro, you can create Commodity flows of the emissions you wish to track. It is common to have these flows meet at one or more Nodes to track total emissions and apply constraints to them.</p><p>Here we define a <code>co2_sink</code> Node which we will use to track all <code>CO2</code> emissions in our System. We have added a <code>CO2CapConstraint</code> and set its right-hand side (RHS) value to 0, meaning the CO2 flows at this Node must net to zero over the period of operations.</p><p>Becasue this is a common way to formulate emissions tracking, we have made the <code>co2_sink</code> ID a special case in Macro. Most emitting Assets have the ability to automatically connect their <code>Edge{CO2}</code> emissions flows to a <code>co2_sink</code> Node if it exists in the System.</p><p>In this example we have also added to Nodes to allow for captured CO2 to be sequestered. These <code>Node{CO2Captured}</code> Nodes have <code>CO2StorageConstraint</code> constraints which allow and limit the tonnes of CO2 that can be injected into each Node annually. The <code>rhs_policy</code> field sets the annual limit for each Node, in this case 4,753,600 tonnes for Boston and 5,145,400 tonnes for Princeton.</p><p>Sequestration could be modelled using a <code>Storage{CO2}</code> component but <code>Storage</code> components are required to have zero net stored flow over the period of operations. This means that the <code>Storage</code> component would not allow for a net injection of CO2 into the Node, which is what we want to model here.</p><pre><code class="language-json hljs">{
    &quot;nodes&quot;: [
        {
            &quot;type&quot;: &quot;CO2&quot;,
            &quot;global_data&quot;: {
                &quot;time_interval&quot;: &quot;CO2&quot;
            },
            &quot;instance_data&quot;: [
                {
                    &quot;id&quot;: &quot;co2_sink&quot;,
                    &quot;constraints&quot;: {
                        &quot;CO2CapConstraint&quot;: true
                    },
                    &quot;rhs_policy&quot;: {
                        &quot;CO2CapConstraint&quot;: 0
                    }
                }
            ]
        },
        {
            &quot;type&quot;: &quot;CO2Captured&quot;,
            &quot;global_data&quot;: {
                &quot;time_interval&quot;: &quot;CO2Captured&quot;
            },
            &quot;instance_data&quot;: [
                {
                    &quot;id&quot;: &quot;boston_co2_storage&quot;,
                    &quot;location&quot;: &quot;boston&quot;,
                    &quot;constraints&quot;: {
                        &quot;CO2StorageConstraint&quot;: true
                    },
                    &quot;rhs_policy&quot;: {
                        &quot;CO2StorageConstraint&quot;: 4753600
                    }
                },
                {
                    &quot;id&quot;: &quot;princeton_co2_storage&quot;,
                    &quot;location&quot;: &quot;princeton&quot;,
                    &quot;constraints&quot;: {
                        &quot;CO2StorageConstraint&quot;: true
                    },
                    &quot;rhs_policy&quot;: {
                        &quot;CO2StorageConstraint&quot;: 5145400
                    }
                }
            ]
        }
    ]
}</code></pre><h3 id="Nodes-in-Assets"><a class="docs-heading-anchor" href="#Nodes-in-Assets">Nodes in Assets</a><a id="Nodes-in-Assets-1"></a><a class="docs-heading-anchor-permalink" href="#Nodes-in-Assets" title="Permalink"></a></h3><p>Nodes can be added to Assets to allow for the merging or splitting of Commodity flows. This is useful when you want to aggregate multiple sub-commodities into a single commodity flow or distribute a single commodity flow into multiple streams. Nodes are not as commonly used in Assets as the other components. In many instances you will prefer to merge or split flows between Assets.</p><p>The <a href="../../Guides/Modeler Guide/modeler_build_asset/#modeler_create_asset">Modellers guide on creating Assets</a> provides a detailed overview of how to create Assets and add Nodes to them. Below is a brief example of how to use Nodes within an Asset.</p><h4 id="Natual-Gas-Power-Plant-with-Station-Power"><a class="docs-heading-anchor" href="#Natual-Gas-Power-Plant-with-Station-Power">Natual Gas Power Plant with Station Power</a><a id="Natual-Gas-Power-Plant-with-Station-Power-1"></a><a class="docs-heading-anchor-permalink" href="#Natual-Gas-Power-Plant-with-Station-Power" title="Permalink"></a></h4><p>In this example, we create a <code>StationPowerExample</code> Asset representing a natural gas power plant with station power requirements. Station power is usually accounted for by the <code>Transformation</code> component. The stochiometric balance between the fuel and exported electricity flows will include the station power required to run the pumps, compressors, and other equipment at the plant.</p><p>In this case, we will explicitly track the station power using an <code>Edge{Electricity}</code> connected to a <code>Node{Electricity}</code>. We will add the station power edge as an incoming Edge to the <code>Transformation</code>. The stochiometric balance will be used to control the station power required. In the future, we could use the Node to add a fixed station power demand on top of the output-dependent station power.</p><div class="mermaid">flowchart TD
    A((Natural Gas Supply))
    subgraph Power Plant
        direction TB
        T{{Transformation}}
        N((Electricity Node))
    end
    A --&gt;|Fuel Intake| T
    T --&gt;|Generated Electricity| N
    N --&gt;|Station Power| T
    N --&gt;|Exported Electricity| C
    T --&gt;|CO2 Emissions| F
    C((Electricity Demand))
    F((CO2 Emissions))</div><pre><code class="language-julia hljs">struct StationPowerExample &lt;: AbstractAsset
    id::AssetId
    thermal_transform::Transformation
    elec_node::Node{&lt;:Electricity}
    generated_elec_edge::Union{Edge{&lt;:Electricity},EdgeWithUC{&lt;:Electricity}}
    station_elec_edge::Edge{&lt;:Electricity}
    exported_elec_edge::Edge{&lt;:Electricity}
    fuel_edge::Edge{&lt;:T}
    co2_edge::Edge{&lt;:CO2}
end&gt;

# You will need to define additional constructors and the default inputs here

function make(asset_type::Type{StationPowerExample}, data::AbstractDict{Symbol,Any}, system::System)
    id = AssetId(data[:id])
    @setup_data(asset_type, data, id)

    thermal_key = :transforms
    # ... setup and create the Transformation

    elec_node_key = :elec_node
    @process_data(
        elec_node_data, 
        data[:nodes][elec_node_key], 
        [
            (data[:nodes][elec_node_key], key),
            (data[:nodes][elec_node_key], Symbol(&quot;elec_node_&quot;, key)),
            (data, Symbol(&quot;elec_node_&quot;, key)),
        ]
    )
    elec_node_data[:id] = Symbol(id, &quot;_&quot;, elec_node_key)
    elec_node = Node(
        elec_node_data,
        system.timedata[:Electricity],
        Electricity
    )

    generated_elec_key = :generated_elec_edge
    # ... create an Edge{Electricity} between the Transformation and the Electricity Node

    station_elec_key = :station_elec_edge
    # ... create an Edge{Electricity} for the station power, connecting the Node to the Transformation

    exported_elec_key = :exported_elec_edge
    # ... create an Edge{Electricity} for the electricity export, connecting the Node to the external demand

    fuel_key = :fuel_edge
    # ... create an Edge{NaturalGas} for the fuel supply, connecting the fuel Node to the Transformation

    co2_key = :co2_edge
    # ... create an Edge{CO2} for the CO2 emissions, connecting the Transformation to the CO2 sink Node

    # ... set up the stochiometric balance between the fuel, station power, and generated electricity flows

    return StationPowerExample(
        id,
        thermal_transform,
        elec_node,
        generated_elec_edge,
        station_elec_edge,
        exported_elec_edge,
        fuel_edge,
        co2_edge
    )
end</code></pre><h5 id="Natual-Gas-Power-Plant-with-Station-Power,-Standard-JSON-Input-Format"><a class="docs-heading-anchor" href="#Natual-Gas-Power-Plant-with-Station-Power,-Standard-JSON-Input-Format">Natual Gas Power Plant with Station Power, Standard JSON Input Format</a><a id="Natual-Gas-Power-Plant-with-Station-Power,-Standard-JSON-Input-Format-1"></a><a class="docs-heading-anchor-permalink" href="#Natual-Gas-Power-Plant-with-Station-Power,-Standard-JSON-Input-Format" title="Permalink"></a></h5><p>Using the default JSON input format and carefully chosen defaults, our new Asset will only require one additional field specifying the station power required per unit of fuel or MWh of electricity generated. The creation and connection of the Node will be handled by the <code>make()</code> function. Here, we&#39;ve used the latter by creating a <code>station_power_per_MWh</code> field. This must be accessed and added to the stochiometric balance in the <code>make()</code> function.</p><pre><code class="language-json hljs">{
    &quot;type&quot;: &quot;StationPowerExample&quot;,
    &quot;global_data&quot;: {},
    &quot;instance_data&quot;: {
        &quot;id&quot;: &quot;example_natural_gas_power_plant&quot;,
        &quot;location&quot;: &quot;boston&quot;,
        &quot;timedata&quot;: &quot;NaturalGas&quot;,
        &quot;fuel_commodity&quot;: &quot;NaturalGas&quot;,
        &quot;co2_sink&quot;: &quot;co2_sink&quot;,
        &quot;uc&quot;: true,
        &quot;elec_constraints&quot;: {
            &quot;CapacityConstraint&quot;: true,
            &quot;RampingLimitConstraint&quot;: true,
            &quot;MinFlowConstraint&quot;: true,
            &quot;MinUpTimeConstraint&quot;: true,
            &quot;MinDownTimeConstraint&quot;: true,
        },
        &quot;emission_rate&quot;: 0.181048235160161,
        &quot;fuel_consumption&quot;: 2.249613533,
        &quot;station_power_per_MWh&quot;: 0.05,
        &quot;can_expand&quot;: false,
        &quot;existing_capacity&quot;: 4026.4,
        &quot;investment_cost&quot;: 0.0,
        &quot;fixed_om_cost&quot;: 16001,
        &quot;variable_om_cost&quot;: 4.415,
        &quot;capacity_size&quot;: 125.825,
        &quot;startup_cost&quot;: 89.34,
        &quot;startup_fuel_consumption&quot;: 0.58614214,
        &quot;min_up_time&quot;: 6,
        &quot;min_down_time&quot;: 6,
        &quot;ramp_up_fraction&quot;: 0.64,
        &quot;ramp_down_fraction&quot;: 0.64,
        &quot;min_flow_fraction&quot;: 0.444
    }
}</code></pre><h5 id="Natual-Gas-Power-Plant-with-Station-Power,-Advanced-JSON-Input-Format"><a class="docs-heading-anchor" href="#Natual-Gas-Power-Plant-with-Station-Power,-Advanced-JSON-Input-Format">Natual Gas Power Plant with Station Power, Advanced JSON Input Format</a><a id="Natual-Gas-Power-Plant-with-Station-Power,-Advanced-JSON-Input-Format-1"></a><a class="docs-heading-anchor-permalink" href="#Natual-Gas-Power-Plant-with-Station-Power,-Advanced-JSON-Input-Format" title="Permalink"></a></h5><p>The advanced JSON inputs will require additional fields to specify the Node and additional Edges. The <code>make()</code> function will handle the internal connections. These inputs could be significantly simplified by improving the default values for the fields using the <code>full_default_data()</code> function.</p><pre><code class="language-json hljs">{
    &quot;type&quot;: &quot;ThermalPower&quot;,
    &quot;global_data&quot;: {},
    &quot;instance_data&quot;: {
        &quot;id&quot;: &quot;example_natural_gas_power_plant&quot;,
        &quot;transforms&quot;: {
            &quot;emission_rate&quot;: 0.181048235160161,
            &quot;fuel_consumption&quot;: 2.249613533,
            &quot;station_power_per_MWh&quot;: 0.05,
        },
        &quot;nodes&quot;: {
            &quot;elec_node&quot;: {
                &quot;commodity&quot;: &quot;Electricity&quot;,
                &quot;timedata&quot;: &quot;Electricity&quot;,
                &quot;constraints&quot;: {
                    &quot;BalanceConstraint&quot;: true
                },
            }
        },
        &quot;edges&quot;: {
            &quot;exported_elec&quot;: {
                &quot;commodity&quot;: &quot;Electricity&quot;,
                &quot;unidirectional&quot;: true,
                &quot;has_capacity&quot;: true,
                &quot;uc&quot;: true,
                &quot;integer_decisions&quot;: false,
                &quot;constraints&quot;: {
                    &quot;CapacityConstraint&quot;: true,
                    &quot;RampingLimitConstraint&quot;: true,
                    &quot;MinFlowConstraint&quot;: true,
                    &quot;MinUpTimeConstraint&quot;: true,
                    &quot;MinDownTimeConstraint&quot;: true
                },
               &quot;end_vertex&quot;: &quot;boston_elec&quot;,
                &quot;can_retire&quot;: true,
                &quot;can_expand&quot;: false,
                &quot;existing_capacity&quot;: 4026.4,
                &quot;investment_cost&quot;: 0.0,
                &quot;fixed_om_cost&quot;: 16001,
                &quot;variable_om_cost&quot;: 4.415,
                &quot;capacity_size&quot;: 125.825,
                &quot;startup_cost&quot;: 89.34,
                &quot;startup_fuel_consumption&quot;: 0.58614214,
                &quot;min_up_time&quot;: 6,
                &quot;min_down_time&quot;: 6,
                &quot;ramp_up_fraction&quot;: 0.64,
                &quot;ramp_down_fraction&quot;: 0.64,
                &quot;min_flow_fraction&quot;: 0.444
            },
            &quot;generated_elec_edge&quot;: {
                &quot;commodity&quot;: &quot;Electricity&quot;,
                &quot;unidirectional&quot;: true,
                &quot;has_capacity&quot;: false
            },
            &quot;station_elec_edge&quot;: {
                &quot;commodity&quot;: &quot;Electricity&quot;,
                &quot;unidirectional&quot;: true,
                &quot;has_capacity&quot;: false
            },
            &quot;fuel_edge&quot;: {
                &quot;commodity&quot;: &quot;NaturalGas&quot;,
                &quot;unidirectional&quot;: true,
                &quot;has_capacity&quot;: false,
                &quot;start_vertex&quot;: &quot;boston_natgas&quot;
            },
            &quot;co2_edge&quot;: {
                &quot;commodity&quot;: &quot;CO2&quot;,
                &quot;unidirectional&quot;: true,
                &quot;has_capacity&quot;: false,
                &quot;end_vertex&quot;: &quot;co2_sink&quot;
            }
        }
    }
}</code></pre><h2 id="See-Also"><a class="docs-heading-anchor" href="#See-Also">See Also</a><a id="See-Also-1"></a><a class="docs-heading-anchor-permalink" href="#See-Also" title="Permalink"></a></h2><ul><li><a href="../Edges/#Edges">Edges</a> - Components that connect Vertices and carry flows</li><li><a href="../Transformations/#Transformations">Transformations</a> - Processes that transform flows between edges</li><li><a href="../../References/3_macro_objects/#MacroEnergy.Storage">Storage</a> - Energy storage components that can be connected to edges</li><li><a href="../Vertices/#Vertices">Vertices</a> - Network nodes that edges connect</li><li><a href="../Assets/#Assets">Assets</a> - Higher-level components made from edges, nodes,</li><li><a href="../Commodities/#Commodities">Commodities</a> - Types of resources flowing through edges  </li><li><a href="../TimeData/#Time-Data">Time Data</a> - Temporal modeling framework</li><li><a href="../Constraints/#Constraints">Constraints</a> - Additional constraints for edges</li></ul><script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
mermaid.initialize({
    startOnLoad: true,
    theme: "neutral"
});
</script></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Edges/">« Edges</a><a class="docs-footer-nextpage" href="../Storage/">Storage »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Wednesday 17 September 2025 21:27">Wednesday 17 September 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
