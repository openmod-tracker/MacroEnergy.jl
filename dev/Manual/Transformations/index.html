<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Transformations · Macro</title><meta name="title" content="Transformations · Macro"/><meta property="og:title" content="Transformations · Macro"/><meta property="twitter:title" content="Transformations · Macro"/><meta name="description" content="Documentation for Macro."/><meta property="og:description" content="Documentation for Macro."/><meta property="twitter:description" content="Documentation for Macro."/><meta property="og:url" content="https://macroenergy.github.io/Macro/stable/Manual/Transformations/"/><meta property="twitter:url" content="https://macroenergy.github.io/Macro/stable/Manual/Transformations/"/><link rel="canonical" href="https://macroenergy.github.io/Macro/stable/Manual/Transformations/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Macro</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><input class="collapse-toggle" id="menuitem-1" type="checkbox"/><label class="tocitem" for="menuitem-1"><span class="docs-label">Welcome to Macro</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../../table_of_contents/">Table of contents</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Getting Started</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Getting Started/1_overview/">Overview</a></li><li><a class="tocitem" href="../../Getting Started/2_installation/">Installation</a></li><li><a class="tocitem" href="../../Getting Started/4_macro_repo_contents/">What&#39;s Included With Macro</a></li><li><a class="tocitem" href="../../Getting Started/3_first_run/">First Run</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Tutorials/tutorials_introduction/">Introduction</a></li><li><a class="tocitem" href="../../Tutorials/0_getting_started/">Getting Started</a></li><li><a class="tocitem" href="../../Tutorials/1_running_macro/">Running Macro</a></li><li><a class="tocitem" href="../../Tutorials/2_multisector_modelling/">Multisector Modelling</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Guides</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Guides/guides_introduction/">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">User Guide</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Guides/User Guide/user_build_system/">Create a System</a></li><li><a class="tocitem" href="../../Guides/User Guide/user_add_commodity/">Adding Commodities</a></li><li><a class="tocitem" href="../../Guides/User Guide/user_add_node/">Adding Nodes</a></li><li><a class="tocitem" href="../../Guides/User Guide/user_add_location/">Adding Locations</a></li><li><a class="tocitem" href="../../Guides/User Guide/user_add_asset/">Adding Assets</a></li><li><a class="tocitem" href="../../Guides/User Guide/user_policy_constraints/">Adding Policy constraints</a></li><li><a class="tocitem" href="../../Guides/User Guide/user_asset_constraints/">Adding Assets constraints</a></li><li><a class="tocitem" href="../../Guides/User Guide/user_settings/">Configuring Settings</a></li><li><a class="tocitem" href="../../Guides/User Guide/user_run_model/">Running Models</a></li><li><a class="tocitem" href="../../Guides/User Guide/user_write_results/">Writing Results</a></li><li><a class="tocitem" href="../../Guides/User Guide/user_multiperiod/">Using Multi-Period Models</a></li><li><a class="tocitem" href="../../Guides/User Guide/user_using_asset_libary/">Exploring the Asset library</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Modeler Guide</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Guides/Modeler Guide/modeler_introduction/">Introduction</a></li><li><a class="tocitem" href="../../Guides/Modeler Guide/modeler_es_graph/">Energy System Graph-Based Representation</a></li><li><a class="tocitem" href="../../Guides/Modeler Guide/modeler_build_sectors/">Creating a New Sector</a></li><li><a class="tocitem" href="../../Guides/Modeler Guide/modeler_build_asset/">Creating a New Asset</a></li><li><a class="tocitem" href="../../Guides/Modeler Guide/modeler_create_example_case/">Creating a New Example Case</a></li><li><a class="tocitem" href="../../Guides/Modeler Guide/modeler_workflow/">Suggested Development Workflow</a></li><li><a class="tocitem" href="../../Guides/Modeler Guide/modeler_debugging_testing/">Debugging and Testing Tips</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-4" type="checkbox"/><label class="tocitem" for="menuitem-4-4"><span class="docs-label">Developer Guide</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Guides/Developer Guide/dev_create_constraint/">Creating a Constraint</a></li><li><a class="tocitem" href="../../Guides/Developer Guide/2_type_hierarchy/">Type Hierarchy</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox" checked/><label class="tocitem" for="menuitem-5"><span class="docs-label">Manual</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../manual_introduction/">Introduction</a></li><li><a class="tocitem" href="../Inputs/">Inputs</a></li><li><a class="tocitem" href="../Outputs/">Outputs</a></li><li><a class="tocitem" href="../System/">System</a></li><li><a class="tocitem" href="../Model/">Model</a></li><li><a class="tocitem" href="../Sectors/">Sectors</a></li><li><a class="tocitem" href="../Edges/">Edges</a></li><li><a class="tocitem" href="../Nodes/">Nodes</a></li><li><a class="tocitem" href="../Storage/">Storage</a></li><li class="is-active"><a class="tocitem" href>Transformations</a><ul class="internal"><li><a class="tocitem" href="#Contents"><span>Contents</span></a></li><li><a class="tocitem" href="#manual-transformations-overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Transformation-Fields"><span>Transformation Fields</span></a></li><li><a class="tocitem" href="#manual-transformations-types"><span>Types</span></a></li><li><a class="tocitem" href="#manual-transformations-constructors"><span>Constructors</span></a></li><li><a class="tocitem" href="#manual-transformations-methods"><span>Methods</span></a></li><li><a class="tocitem" href="#manual-transformations-examples"><span>Examples</span></a></li><li><a class="tocitem" href="#See-Also"><span>See Also</span></a></li></ul></li><li><a class="tocitem" href="../Locations/">Locations</a></li><li><a class="tocitem" href="../Constraints/">Constraints</a></li><li><a class="tocitem" href="../Commodities/">Commodities</a></li><li><a class="tocitem" href="../assets/1_introduction/">Assets</a></li><li><input class="collapse-toggle" id="menuitem-5-15" type="checkbox"/><label class="tocitem" for="menuitem-5-15"><span class="docs-label">Asset Library</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../assets/battery/">Battery</a></li><li><a class="tocitem" href="../assets/beccselectricity/">BECCS Electricity</a></li><li><a class="tocitem" href="../assets/beccshydrogen/">BECCS Hydrogen</a></li><li><a class="tocitem" href="../assets/electricdac/">Electric DAC</a></li><li><a class="tocitem" href="../assets/electrolyzer/">Electrolyzer</a></li><li><a class="tocitem" href="../assets/fuelcell/">Fuel Cell</a></li><li><a class="tocitem" href="../assets/gasstorage/">Gas Storage</a></li><li><a class="tocitem" href="../assets/hydrogenline/">Hydrogen Line</a></li><li><a class="tocitem" href="../assets/hydropower/">Hydro Reservoir</a></li><li><a class="tocitem" href="../assets/mustrun/">Must Run</a></li><li><a class="tocitem" href="../assets/natgasdaq/">Natural Gas DAC</a></li><li><a class="tocitem" href="../assets/transmissionlink/">Transmission Link</a></li><li><a class="tocitem" href="../assets/thermalhydrogen/">Thermal Hydrogen Plant (with and without CCS)</a></li><li><a class="tocitem" href="../assets/thermalpower/">Thermal Power Plant (with and without CCS)</a></li><li><a class="tocitem" href="../assets/vre/">Variable Renewable Energy resources (VRE)</a></li></ul></li><li><a class="tocitem" href="../Financial_assumptions/">Financial Assumptions</a></li><li><a class="tocitem" href="../Multi_period_accounting/">Multi-Period Accounting</a></li></ul></li><li><a class="tocitem" href="../../how_to_contribute/">How to contribute</a></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">References</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../References/1_introduction/">Introduction</a></li><li><a class="tocitem" href="../../References/2_reading_input/">Reading input data</a></li><li><a class="tocitem" href="../../References/3_macro_objects/">Macro Objects</a></li><li><a class="tocitem" href="../../References/4_writing_output/">Writing output data</a></li><li><a class="tocitem" href="../../References/5_utilities/">Utilities</a></li><li><a class="tocitem" href="../../References/ref_download_examples/">Downloading examples</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Transformations</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Transformations</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/macroenergy/MacroEnergy.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/macroenergy/MacroEnergy.jl/blob/main/docs/src/Manual/Transformations.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Transformations"><a class="docs-heading-anchor" href="#Transformations">Transformations</a><a id="Transformations-1"></a><a class="docs-heading-anchor-permalink" href="#Transformations" title="Permalink"></a></h1><h2 id="Contents"><a class="docs-heading-anchor" href="#Contents">Contents</a><a id="Contents-1"></a><a class="docs-heading-anchor-permalink" href="#Contents" title="Permalink"></a></h2><p><a href="#manual-transformations-overview">Overview</a> | <a href="#Transformation-Fields">Fields</a> | <a href="#manual-transformations-types">Types</a> | <a href="#manual-transformations-constructors">Constructors</a> | <a href="#manual-transformations-methods">Methods</a> | <a href="#manual-transformations-examples">Examples</a></p><h2 id="manual-transformations-overview"><a class="docs-heading-anchor" href="#manual-transformations-overview">Overview</a><a id="manual-transformations-overview-1"></a><a class="docs-heading-anchor-permalink" href="#manual-transformations-overview" title="Permalink"></a></h2><p><code>Transformations</code> balance flows of several Commodities, handling the conversion of one or more Commodities into one or more others. They are one of the four primary components in Macro, alongside <code>Nodes</code>, <code>Edges</code>, and <code>Storage</code>. They are sub-types of the <code>Vertex</code> type.</p><p>Unlike <code>Nodes</code>, which balance flows of a single Commodity, <code>Transformations</code> manage multi-commodity conversion processes. They rely on user-defined stoichiometric balances to govern these multi-flow relationships. They are essential for modeling energy conversion technologies, chemical processes, and other systems that transform one form of energy or material into another.</p><h3 id="Transformations-in-Assets"><a class="docs-heading-anchor" href="#Transformations-in-Assets">Transformations in Assets</a><a id="Transformations-in-Assets-1"></a><a class="docs-heading-anchor-permalink" href="#Transformations-in-Assets" title="Permalink"></a></h3><p><code>Transformation</code> components are typically incorporated into Assets, representing the ability of those Assets to convert between different Commodities. This could be used to model:</p><ul><li><strong>Power Plants</strong>: Converting fuel (natural gas, coal, uranium) into electricity and emissions</li><li><strong>Chemical Plants</strong>: Converting raw materials and fuel into chemical products</li><li><strong>Gas Pipelines</strong>: Electricty is required to run compressors and pumps, facilitating the flow of gases. This can be modeled as a <code>Transformation</code> that converts <code>Electricity</code> and <code>NaturalGas</code> into a second flow of <code>NaturalGas</code>.</li></ul><h4 id="Natural-Gas-Power-Plant-Asset"><a class="docs-heading-anchor" href="#Natural-Gas-Power-Plant-Asset">Natural Gas Power Plant Asset</a><a id="Natural-Gas-Power-Plant-Asset-1"></a><a class="docs-heading-anchor-permalink" href="#Natural-Gas-Power-Plant-Asset" title="Permalink"></a></h4><p>A natural gas power plant Asset can be modeled using a <code>Transformation</code> component that converts <code>NaturalGas</code> into <code>Electricity</code>, <code>CO2</code>. Other formulations may account for oxidizer and waste heat. The <code>Transformation</code> component uses stoichiometric balances to define the conversion ratios, such as the heat rate (fuel consumption per unit electricity) and emission factor (CO2 per unit fuel). The <code>Edges</code> connected to the <code>Transformation</code> handle the actual flows, including flow / capacity limits, while the <code>Transformation</code> enforces the conversion relationships.</p><h4 id="Multi-Product-Refineries"><a class="docs-heading-anchor" href="#Multi-Product-Refineries">Multi-Product Refineries</a><a id="Multi-Product-Refineries-1"></a><a class="docs-heading-anchor-permalink" href="#Multi-Product-Refineries" title="Permalink"></a></h4><p>Complex industrial processes like refineries can use multiple <code>Transformation</code> components to model different conversion units. Each <code>Transformation</code> handles a specific conversion process (e.g., distillation, cracking, reforming) with its own stoichiometric relationships, allowing for detailed modeling of multi-product facilities.</p><h3 id="Transformations-Outside-of-Assets"><a class="docs-heading-anchor" href="#Transformations-Outside-of-Assets">Transformations Outside of Assets</a><a id="Transformations-Outside-of-Assets-1"></a><a class="docs-heading-anchor-permalink" href="#Transformations-Outside-of-Assets" title="Permalink"></a></h3><p><code>Transformation</code> components can be used outside of Assets, but there is no standard input file format to do so currently. Most Users will be better served by using <code>Transformation</code> components within Assets, as this allows for more complex interactions and standardized input formats. However, it is possible to define <code>Transformations</code> directly in the Julia script you use to build and solve your model. Please feel free to reach out to the development team via a GitHub issue if you have a use case for this.</p><h3 id="Key-Concepts"><a class="docs-heading-anchor" href="#Key-Concepts">Key Concepts</a><a id="Key-Concepts-1"></a><a class="docs-heading-anchor-permalink" href="#Key-Concepts" title="Permalink"></a></h3><ul><li><strong>Multi-Commodity Conversion</strong>: Transformations handle conversion between flows of several Commodity using multi-commodity balance constraints</li><li><strong>Stoichiometric Balances</strong>: User-defined relationships govern the conversion ratios between input and output flows</li><li><strong>Asset Integration</strong>: Transformations are typically used within Assets to model conversion technologies</li></ul><h2 id="Transformation-Fields"><a class="docs-heading-anchor" href="#Transformation-Fields">Transformation Fields</a><a id="Transformation-Fields-1"></a><a class="docs-heading-anchor-permalink" href="#Transformation-Fields" title="Permalink"></a></h2><p><code>Transformations</code> have the following fields. When running a model, the fields are set by the input files. When creating an Asset, the defaults below can be altered using the <code>@transform_data</code> macro. The internal fields are used by Macro and are not intended to be set by users in most circumstances.</p><p>Moreso than other components, <code>Transformations</code> rely heavily on additional inputs defined as part of the Asset they are a part of. These additional inputs are used to define the stoichiometric balances of the <code>Transformation</code>. These are not shown in the following tables as they are not part of the <code>Transformation</code> itself, but rather part of the Asset that contains the <code>Transformation</code>.</p><div class="admonition is-info" id="Units-in-Macro-fa43ee5504ac88cc"><header class="admonition-header">Units in Macro<a class="admonition-anchor" href="#Units-in-Macro-fa43ee5504ac88cc" title="Permalink"></a></header><div class="admonition-body"><p>We have assumed that your System is using units of MWh for energy, tonnes for mass, and hour-long time steps. You can use any set of units as long as they are consistent across your operations and investment inputs.</p></div></div><h3 id="Network-Structure"><a class="docs-heading-anchor" href="#Network-Structure">Network Structure</a><a id="Network-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#Network-Structure" title="Permalink"></a></h3><table><tr><th style="text-align: right">Field</th><th style="text-align: right">Type</th><th style="text-align: right">Description</th><th style="text-align: right">Default</th></tr><tr><td style="text-align: right"><code>id</code></td><td style="text-align: right">Symbol</td><td style="text-align: right">Unique identifier</td><td style="text-align: right">-</td></tr><tr><td style="text-align: right"><code>location</code></td><td style="text-align: right">Union{Missing,Symbol}</td><td style="text-align: right">Location where transformation is placed</td><td style="text-align: right">missing</td></tr></table><h3 id="Stoichiometric-Balance-Data-(Internal)"><a class="docs-heading-anchor" href="#Stoichiometric-Balance-Data-(Internal)">Stoichiometric Balance Data (Internal)</a><a id="Stoichiometric-Balance-Data-(Internal)-1"></a><a class="docs-heading-anchor-permalink" href="#Stoichiometric-Balance-Data-(Internal)" title="Permalink"></a></h3><table><tr><th style="text-align: right">Field</th><th style="text-align: right">Type</th><th style="text-align: right">Description</th><th style="text-align: right">Units</th><th style="text-align: right">Default</th></tr><tr><td style="text-align: right"><code>balance_data</code></td><td style="text-align: right">Dict{Symbol,Dict{Symbol,Float64}}</td><td style="text-align: right">Stoichiometric equation coefficients</td><td style="text-align: right">varies</td><td style="text-align: right">Dict{Symbol,Dict{Symbol,Float64}}()</td></tr><tr><td style="text-align: right"><code>constraints</code></td><td style="text-align: right">Vector{AbstractTypeConstraint}</td><td style="text-align: right">Additional constraints</td><td style="text-align: right">-</td><td style="text-align: right">Vector{AbstractTypeConstraint}()</td></tr><tr><td style="text-align: right"><code>operation_expr</code></td><td style="text-align: right">Dict</td><td style="text-align: right">Operational JuMP expressions</td><td style="text-align: right">-</td><td style="text-align: right">Dict()</td></tr></table><h3 id="Time-Related-Data-(Internal)"><a class="docs-heading-anchor" href="#Time-Related-Data-(Internal)">Time-Related Data (Internal)</a><a id="Time-Related-Data-(Internal)-1"></a><a class="docs-heading-anchor-permalink" href="#Time-Related-Data-(Internal)" title="Permalink"></a></h3><table><tr><th style="text-align: right">Field</th><th style="text-align: right">Type</th><th style="text-align: right">Description</th><th style="text-align: right">Units</th><th style="text-align: right">Default</th></tr><tr><td style="text-align: right"><code>timedata</code></td><td style="text-align: right">TimeData</td><td style="text-align: right">Time-related modeling data</td><td style="text-align: right">-</td><td style="text-align: right">-</td></tr></table><h2 id="manual-transformations-types"><a class="docs-heading-anchor" href="#manual-transformations-types">Types</a><a id="manual-transformations-types-1"></a><a class="docs-heading-anchor-permalink" href="#manual-transformations-types" title="Permalink"></a></h2><h3 id="Type-Hierarchy"><a class="docs-heading-anchor" href="#Type-Hierarchy">Type Hierarchy</a><a id="Type-Hierarchy-1"></a><a class="docs-heading-anchor-permalink" href="#Type-Hierarchy" title="Permalink"></a></h3><p><code>Transformation</code> types follow a hierarchical structure rooted in the abstract <code>AbstractVertex</code> type:</p><pre><code class="language-julia hljs">AbstractVertex
├── Node{T}
├── AbstractStorage{T}
│   ├── Storage{T}
│   └── LongDurationStorage{T}
└── Transformation</code></pre><h3 id="Transformation"><a class="docs-heading-anchor" href="#Transformation">Transformation</a><a id="Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Transformation" title="Permalink"></a></h3><p>The Transformation type represents conversion processes between different commodities. Unlike other vertex types that are parameterized by commodity type, Transformations handle multiple commodities simultaneously through stoichiometric balance equations.</p><h2 id="manual-transformations-constructors"><a class="docs-heading-anchor" href="#manual-transformations-constructors">Constructors</a><a id="manual-transformations-constructors-1"></a><a class="docs-heading-anchor-permalink" href="#manual-transformations-constructors" title="Permalink"></a></h2><h3 id="Keyword-Constructors"><a class="docs-heading-anchor" href="#Keyword-Constructors">Keyword Constructors</a><a id="Keyword-Constructors-1"></a><a class="docs-heading-anchor-permalink" href="#Keyword-Constructors" title="Permalink"></a></h3><pre><code class="language-julia hljs">Transformation(; id::Symbol, timedata::TimeData, [additional_fields...])</code></pre><p>Direct constructors using keyword arguments for all fields.</p><table><tr><th style="text-align: right">Parameter</th><th style="text-align: right">Type</th><th style="text-align: right">Description</th><th style="text-align: right">Required</th></tr><tr><td style="text-align: right"><code>id</code></td><td style="text-align: right">Symbol</td><td style="text-align: right">Unique identifier</td><td style="text-align: right">Yes</td></tr><tr><td style="text-align: right"><code>timedata</code></td><td style="text-align: right">TimeData</td><td style="text-align: right">Time-related data structure</td><td style="text-align: right">Yes</td></tr><tr><td style="text-align: right"><code>location</code></td><td style="text-align: right">Union{Missing,Symbol}</td><td style="text-align: right">Location where transformation is placed</td><td style="text-align: right">No</td></tr><tr><td style="text-align: right"><code>balance_data</code></td><td style="text-align: right">Dict{Symbol,Dict{Symbol,Float64}}</td><td style="text-align: right">Stoichiometric equation coefficients</td><td style="text-align: right">No</td></tr><tr><td style="text-align: right"><code>constraints</code></td><td style="text-align: right">Vector{AbstractTypeConstraint}</td><td style="text-align: right">Additional constraints</td><td style="text-align: right">No</td></tr><tr><td style="text-align: right"><code>operation_expr</code></td><td style="text-align: right">Dict</td><td style="text-align: right">Operational JuMP expressions</td><td style="text-align: right">No</td></tr></table><h3 id="Primary-Constructors"><a class="docs-heading-anchor" href="#Primary-Constructors">Primary Constructors</a><a id="Primary-Constructors-1"></a><a class="docs-heading-anchor-permalink" href="#Primary-Constructors" title="Permalink"></a></h3><pre><code class="language-julia hljs">Transformation(id::Symbol, data::Dict{Symbol,Any}, time_data::TimeData)</code></pre><p>Creates Transformation components from input data dictionary and time data.</p><table><tr><th style="text-align: right">Parameter</th><th style="text-align: right">Type</th><th style="text-align: right">Description</th></tr><tr><td style="text-align: right"><code>id</code></td><td style="text-align: right">Symbol</td><td style="text-align: right">Unique identifier for the transformation</td></tr><tr><td style="text-align: right"><code>data</code></td><td style="text-align: right">Dict{Symbol,Any}</td><td style="text-align: right">Dictionary of transformation configuration data</td></tr><tr><td style="text-align: right"><code>time_data</code></td><td style="text-align: right">TimeData</td><td style="text-align: right">Time-related data structure</td></tr></table><h3 id="Factory-Constructors"><a class="docs-heading-anchor" href="#Factory-Constructors">Factory Constructors</a><a id="Factory-Constructors-1"></a><a class="docs-heading-anchor-permalink" href="#Factory-Constructors" title="Permalink"></a></h3><pre><code class="language-julia hljs">make_transformation(id::Symbol, data::Dict{Symbol,Any}, time_data::TimeData)</code></pre><p>Internal factory methods for creating Transformation components with data processing.</p><table><tr><th style="text-align: right">Parameter</th><th style="text-align: right">Type</th><th style="text-align: right">Description</th></tr><tr><td style="text-align: right"><code>id</code></td><td style="text-align: right">Symbol</td><td style="text-align: right">Unique identifier for the transformation</td></tr><tr><td style="text-align: right"><code>data</code></td><td style="text-align: right">Dict{Symbol,Any}</td><td style="text-align: right">Configuration data for the transformation</td></tr><tr><td style="text-align: right"><code>time_data</code></td><td style="text-align: right">TimeData</td><td style="text-align: right">Time-related data structure</td></tr></table><h2 id="manual-transformations-methods"><a class="docs-heading-anchor" href="#manual-transformations-methods">Methods</a><a id="manual-transformations-methods-1"></a><a class="docs-heading-anchor-permalink" href="#manual-transformations-methods" title="Permalink"></a></h2><h3 id="Accessor-Methods"><a class="docs-heading-anchor" href="#Accessor-Methods">Accessor Methods</a><a id="Accessor-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Accessor-Methods" title="Permalink"></a></h3><p>Methods for accessing transformation data and properties.</p><table><tr><th style="text-align: right">Method</th><th style="text-align: right">Description</th><th style="text-align: right">Return Type</th></tr><tr><td style="text-align: right"><code>id(transformation)</code></td><td style="text-align: right">Get transformation identifier</td><td style="text-align: right"><code>Symbol</code></td></tr><tr><td style="text-align: right"><code>balance_ids(transformation)</code></td><td style="text-align: right">Get IDs of all balance equations</td><td style="text-align: right"><code>Vector{Symbol}</code></td></tr><tr><td style="text-align: right"><code>balance_data(transformation, i)</code></td><td style="text-align: right">Get input data for balance equation i</td><td style="text-align: right"><code>Dict{Symbol,Float64}</code></td></tr><tr><td style="text-align: right"><code>get_balance(transformation, i)</code></td><td style="text-align: right">Get balance equation expression for i</td><td style="text-align: right"><code>JuMP.Expression</code></td></tr><tr><td style="text-align: right"><code>get_balance(transformation, i, t)</code></td><td style="text-align: right">Get balance equation expression for i at time t</td><td style="text-align: right"><code>JuMP.Expression</code></td></tr></table><h3 id="Balance-and-Constraint-Methods-(Inherited-from-AbstractVertex)"><a class="docs-heading-anchor" href="#Balance-and-Constraint-Methods-(Inherited-from-AbstractVertex)">Balance and Constraint Methods (Inherited from AbstractVertex)</a><a id="Balance-and-Constraint-Methods-(Inherited-from-AbstractVertex)-1"></a><a class="docs-heading-anchor-permalink" href="#Balance-and-Constraint-Methods-(Inherited-from-AbstractVertex)" title="Permalink"></a></h3><p>Methods for managing balance equations and constraints.</p><table><tr><th style="text-align: right">Method</th><th style="text-align: right">Description</th><th style="text-align: right">Return Type</th></tr><tr><td style="text-align: right"><code>all_constraints(transformation)</code></td><td style="text-align: right">Get all constraints applied to the transformation</td><td style="text-align: right"><code>Vector{AbstractTypeConstraint}</code></td></tr><tr><td style="text-align: right"><code>all_constraints_types(transformation)</code></td><td style="text-align: right">Get types of all constraints</td><td style="text-align: right"><code>Vector{DataType}</code></td></tr><tr><td style="text-align: right"><code>get_constraint_by_type(transformation, constraint_type)</code></td><td style="text-align: right">Get constraint of specified type</td><td style="text-align: right"><code>Union{AbstractTypeConstraint,Vector{AbstractTypeConstraint},Nothing}</code></td></tr></table><h3 id="Model-Building-Methods"><a class="docs-heading-anchor" href="#Model-Building-Methods">Model Building Methods</a><a id="Model-Building-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Model-Building-Methods" title="Permalink"></a></h3><p>Methods used internally during model construction.</p><table><tr><th style="text-align: right">Method</th><th style="text-align: right">Description</th><th style="text-align: right">Return Type</th></tr><tr><td style="text-align: right"><code>add_linking_variables!(transformation, model)</code></td><td style="text-align: right">Add linking variables to JuMP model</td><td style="text-align: right"><code>Nothing</code></td></tr><tr><td style="text-align: right"><code>define_available_capacity!(transformation, model)</code></td><td style="text-align: right">Define available capacity constraints</td><td style="text-align: right"><code>Nothing</code></td></tr><tr><td style="text-align: right"><code>planning_model!(transformation, model)</code></td><td style="text-align: right">Add planning model constraints</td><td style="text-align: right"><code>Nothing</code></td></tr><tr><td style="text-align: right"><code>operation_model!(transformation, model)</code></td><td style="text-align: right">Add operational model constraints</td><td style="text-align: right"><code>Nothing</code></td></tr></table><h3 id="Factory-Methods"><a class="docs-heading-anchor" href="#Factory-Methods">Factory Methods</a><a id="Factory-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Factory-Methods" title="Permalink"></a></h3><p>Methods for creating transformation components.</p><table><tr><th style="text-align: right">Method</th><th style="text-align: right">Description</th><th style="text-align: right">Return Type</th></tr><tr><td style="text-align: right"><code>make_transformation(id, data, time_data)</code></td><td style="text-align: right">Create transformation component</td><td style="text-align: right"><code>Transformation</code></td></tr></table><h3 id="Utility-Methods"><a class="docs-heading-anchor" href="#Utility-Methods">Utility Methods</a><a id="Utility-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Utility-Methods" title="Permalink"></a></h3><p>Additional utility methods for working with Transformations.</p><table><tr><th style="text-align: right">Method</th><th style="text-align: right">Description</th><th style="text-align: right">Return Type</th></tr><tr><td style="text-align: right"><code>@transform_data(new_defaults)</code></td><td style="text-align: right">Macro to set new default fields for an Asset</td><td style="text-align: right"><code>Dict{Symbol,Any}</code></td></tr></table><h2 id="manual-transformations-examples"><a class="docs-heading-anchor" href="#manual-transformations-examples">Examples</a><a id="manual-transformations-examples-1"></a><a class="docs-heading-anchor-permalink" href="#manual-transformations-examples" title="Permalink"></a></h2><h3 id="Natural-Gas-Power-Plant-Asset-2"><a class="docs-heading-anchor" href="#Natural-Gas-Power-Plant-Asset-2">Natural Gas Power Plant Asset</a><a class="docs-heading-anchor-permalink" href="#Natural-Gas-Power-Plant-Asset-2" title="Permalink"></a></h3><p>The <code>ThermalPower</code> Asset is an example of how to use <code>Transformation</code> components to model a natural gas power plant. It converts <code>NaturalGas</code> into <code>Electricity</code> and <code>CO2</code>.</p><p>The stochiometric balances of the <code>Transformation</code> are defined by the <code>fuel_consumption</code> and <code>emission_rate</code> fields, which represent the heat rate (fuel consumption per unit electricity) and emission factor (CO2 per unit fuel), respectively.</p><p>The following code snippets show how the <code>Transformation</code> is defined as part of the <code>ThermalPower</code> Asset and how the stochiometric balances are set. Further information about how to create new Assets can be found in the <a href="../Assets/#Assets">Assets manual page</a>.</p><p>The <code>Transformation</code> is one of the components which make up the <code>ThermalPower</code> Asset.</p><pre><code class="language-julia hljs">struct ThermalPower{T} &lt;: AbstractAsset
    id::AssetId
    thermal_transform::Transformation
    elec_edge::Union{Edge{&lt;:Electricity},EdgeWithUC{&lt;:Electricity}}
    fuel_edge::Edge{&lt;:T}
    co2_edge::Edge{&lt;:CO2}
end</code></pre><p>The <code>make()</code> function of the <code>ThermalPower</code> Asset is responsible for creating the <code>Transformation</code> and connecting it to the appropriate <code>Nodes</code> via <code>Edges</code>. The <code>make()</code> function processes the input data and sets up the <code>Transformation</code> with the necessary stoichiometric balances.</p><pre><code class="language-julia hljs">function make(asset_type::Type{ThermalPower}, data::AbstractDict{Symbol,Any}, system::System)
    # Assign a unique ID and set up the default data
    id = AssetId(data[:id])
    @setup_data(asset_type, data, id)

    # Parse the Transformation data and create the Transformation component
    thermal_key = :transforms
    @process_data(
        transform_data, 
        data[thermal_key], 
        [
            (data[thermal_key], key),
            (data[thermal_key], Symbol(&quot;transform_&quot;, key)),
            (data, Symbol(&quot;transform_&quot;, key)),
            (data, key),
        ]
    )
    thermal_transform = Transformation(;
        id = Symbol(id, &quot;_&quot;, thermal_key),
        timedata = system.time_data[Symbol(transform_data[:timedata])],
        constraints = get(transform_data, :constraints, [BalanceConstraint()]),
    )

    elec_edge_key = :elec_edge
    # ... Process the electricity edge data
    elec_start_node = thermal_transform
    @end_vertex(
        elec_end_node,
        elec_edge_data,
        Electricity,
        [(elec_edge_data, :end_vertex), (data, :location)],
    )
    # Check if the edge has unit commitment constraints
    has_uc = get(elec_edge_data, :uc, false)
    EdgeType = has_uc ? EdgeWithUC : Edge
    # Create the elec edge with the appropriate type
    elec_edge = EdgeType(
        Symbol(id, &quot;_&quot;, elec_edge_key),
        elec_edge_data,
        system.time_data[:Electricity],
        Electricity,
        elec_start_node,
        elec_end_node,
    )
    if has_uc
        uc_constraints = [MinUpTimeConstraint(), MinDownTimeConstraint()]
        for c in uc_constraints
            if !(c in elec_edge.constraints)
                push!(elec_edge.constraints, c)
            end
        end
        elec_edge.startup_fuel_balance_id = :energy
    end
    
    fuel_edge_key = :fuel_edge
    # ... Process the fuel edge data
    fuel_end_node = thermal_transform
    fuel_edge = Edge(
        Symbol(id, &quot;_&quot;, fuel_edge_key),
        fuel_edge_data,
        system.time_data[commodity_symbol],
        commodity,
        fuel_start_node,
        fuel_end_node,
    )

    co2_edge_key = :co2_edge
    # ... Process the CO2 edge data
    co2_edge = Edge(
        Symbol(id, &quot;_&quot;, co2_edge_key),
        co2_edge_data,
        system.time_data[:CO2],
        CO2,
        co2_start_node,
        co2_end_node,
    )

    # Set the Transformation&#39;s stochiometric balance constraints. 
    
    # The first constraint sets the fuel -&gt; electricity conversion ratio, which is the heat rate of the power plant.

    # The second constraint sets the fuel -&gt; CO2 conversion ratio, which is the emission factor of the power plant.
    thermal_transform.balance_data = Dict(
        :energy =&gt; Dict(
            elec_edge.id =&gt; get(transform_data, :fuel_consumption, 1.0),
            fuel_edge.id =&gt; 1.0,
            co2_edge.id =&gt; 0.0,
        ),
        :emissions =&gt; Dict(
            fuel_edge.id =&gt; get(transform_data, :emission_rate, 0.0),
            co2_edge.id =&gt; 1.0,
            elec_edge.id =&gt; 0.0,
        ),
    )

    # Finally, we create and return the ThermalPower Asset
    return ThermalPower(id, thermal_transform, elec_edge, fuel_edge, co2_edge)
end</code></pre><h4 id="Nat-Gas,-Standard-JSON-Input-Format"><a class="docs-heading-anchor" href="#Nat-Gas,-Standard-JSON-Input-Format">Nat Gas, Standard JSON Input Format</a><a id="Nat-Gas,-Standard-JSON-Input-Format-1"></a><a class="docs-heading-anchor-permalink" href="#Nat-Gas,-Standard-JSON-Input-Format" title="Permalink"></a></h4><pre><code class="language-json hljs">{
    &quot;type&quot;: &quot;ThermalPower&quot;,
    &quot;global_data&quot;: {},
    &quot;instance_data&quot;: {
        &quot;id&quot;: &quot;example_natural_gas_power_plant&quot;,
        &quot;location&quot;: &quot;boston&quot;,
        &quot;timedata&quot;: &quot;NaturalGas&quot;,
        &quot;fuel_commodity&quot;: &quot;NaturalGas&quot;,
        &quot;co2_sink&quot;: &quot;co2_sink&quot;,
        &quot;uc&quot;: true,
        &quot;elec_constraints&quot;: {
            &quot;CapacityConstraint&quot;: true,
            &quot;RampingLimitConstraint&quot;: true,
            &quot;MinFlowConstraint&quot;: true,
            &quot;MinUpTimeConstraint&quot;: true,
            &quot;MinDownTimeConstraint&quot;: true,
        },
        &quot;emission_rate&quot;: 0.181048235160161,
        &quot;fuel_consumption&quot;: 2.249613533,
        &quot;can_expand&quot;: false,
        &quot;existing_capacity&quot;: 4026.4,
        &quot;investment_cost&quot;: 0.0,
        &quot;fixed_om_cost&quot;: 16001,
        &quot;variable_om_cost&quot;: 4.415,
        &quot;capacity_size&quot;: 125.825,
        &quot;startup_cost&quot;: 89.34,
        &quot;startup_fuel_consumption&quot;: 0.58614214,
        &quot;min_up_time&quot;: 6,
        &quot;min_down_time&quot;: 6,
        &quot;ramp_up_fraction&quot;: 0.64,
        &quot;ramp_down_fraction&quot;: 0.64,
        &quot;min_flow_fraction&quot;: 0.444
    }
}</code></pre><h4 id="Nat-Gas,-Advanced-JSON-Input-Format"><a class="docs-heading-anchor" href="#Nat-Gas,-Advanced-JSON-Input-Format">Nat Gas, Advanced JSON Input Format</a><a id="Nat-Gas,-Advanced-JSON-Input-Format-1"></a><a class="docs-heading-anchor-permalink" href="#Nat-Gas,-Advanced-JSON-Input-Format" title="Permalink"></a></h4><pre><code class="language-json hljs">{
    &quot;type&quot;: &quot;ThermalPower&quot;,
    &quot;global_data&quot;: {},
    &quot;instance_data&quot;: {
        &quot;id&quot;: &quot;example_natural_gas_power_plant&quot;,
        &quot;transforms&quot;: {
            &quot;emission_rate&quot;: 0.181048235160161,
            &quot;fuel_consumption&quot;: 2.249613533
        },
        &quot;edges&quot;: {
            &quot;elec_edge&quot;: {
                &quot;commodity&quot;: &quot;Electricity&quot;,
                &quot;unidirectional&quot;: true,
                &quot;has_capacity&quot;: true,
                &quot;uc&quot;: true,
                &quot;integer_decisions&quot;: false,
                &quot;constraints&quot;: {
                    &quot;CapacityConstraint&quot;: true,
                    &quot;RampingLimitConstraint&quot;: true,
                    &quot;MinFlowConstraint&quot;: true,
                    &quot;MinUpTimeConstraint&quot;: true,
                    &quot;MinDownTimeConstraint&quot;: true
                },
               &quot;end_vertex&quot;: &quot;boston_elec&quot;,
                &quot;can_retire&quot;: true,
                &quot;can_expand&quot;: false,
                &quot;existing_capacity&quot;: 4026.4,
                &quot;investment_cost&quot;: 0.0,
                &quot;fixed_om_cost&quot;: 16001,
                &quot;variable_om_cost&quot;: 4.415,
                &quot;capacity_size&quot;: 125.825,
                &quot;startup_cost&quot;: 89.34,
                &quot;startup_fuel_consumption&quot;: 0.58614214,
                &quot;min_up_time&quot;: 6,
                &quot;min_down_time&quot;: 6,
                &quot;ramp_up_fraction&quot;: 0.64,
                &quot;ramp_down_fraction&quot;: 0.64,
                &quot;min_flow_fraction&quot;: 0.444
            },
            &quot;fuel_edge&quot;: {
                &quot;commodity&quot;: &quot;NaturalGas&quot;,
                &quot;unidirectional&quot;: true,
                &quot;has_capacity&quot;: false,
                &quot;start_vertex&quot;: &quot;boston_natgas&quot;
            },
            &quot;co2_edge&quot;: {
                &quot;commodity&quot;: &quot;CO2&quot;,
                &quot;unidirectional&quot;: true,
                &quot;has_capacity&quot;: false,
                &quot;end_vertex&quot;: &quot;co2_sink&quot;
            }
        }
    }
}</code></pre><h3 id="Gas-Storage-Asset"><a class="docs-heading-anchor" href="#Gas-Storage-Asset">Gas Storage Asset</a><a id="Gas-Storage-Asset-1"></a><a class="docs-heading-anchor-permalink" href="#Gas-Storage-Asset" title="Permalink"></a></h3><p><code>GasStorage</code> Assets are an interesting example of how <code>Transformations</code> can be used to model <code>Electricity</code> flows used to energize another flow, instead of converting between Commodities. The <a href="../Storage/#Hydrogen-Storage">Edges manual page</a> includes an explanation of the <code>make()</code> function and inputs of this Asset.</p><h2 id="See-Also"><a class="docs-heading-anchor" href="#See-Also">See Also</a><a id="See-Also-1"></a><a class="docs-heading-anchor-permalink" href="#See-Also" title="Permalink"></a></h2><ul><li><a href="../Edges/#Edges">Edges</a> - Components that connect Vertices and carry flows</li><li><a href="../Nodes/#Nodes">Nodes</a> - Network nodes that allow for import and export of commodities</li><li><a href="../../References/3_macro_objects/#MacroEnergy.Storage">Storage</a> - Components that store commodities for later use</li><li><a href="../Vertices/#Vertices">Vertices</a> - Network nodes that edges connect</li><li><a href="../Assets/#Assets">Assets</a> - Higher-level components made from edges, nodes, storage, and transformations</li><li><a href="../Commodities/#Commodities">Commodities</a> - Types of resources stored by Commodities</li><li><a href="../TimeData/#Time-Data">Time Data</a> - Temporal modeling framework</li><li><a href="../Constraints/#Constraints">Constraints</a> - Additional constraints for Storage and other components</li></ul><script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
mermaid.initialize({
    startOnLoad: true,
    theme: "neutral"
});
</script></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Storage/">« Storage</a><a class="docs-footer-nextpage" href="../Locations/">Locations »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Friday 18 July 2025 16:03">Friday 18 July 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
